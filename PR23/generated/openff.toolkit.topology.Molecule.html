
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />


  
  <link rel="icon" type="image/svg" href="../_static/images/favicon.svg" />
  <link rel="apple-touch-icon" type="image/svg" href="../_static/images/favicon.svg" />
  

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
  <meta name="theme-color" content="#015480;">
  
  
    <title>openff.toolkit.topology.Molecule &#8212; OpenFF Sphinx theme</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/openff.css" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pydantic API docs" href="../pydantic.html" />
    <link rel="prev" title="Openff-toolkit example" href="../numpydoc.html" />
   
  <link rel="stylesheet" href="../_static/site.css"/>

  </head>
  <body dir=ltr
        data-md-color-accent=openff-toolkit-blue
        class="has-navbar-fixed-top">
  <header data-md-component="header">
  <nav class="navbar is-primary is-fixed-top is-flex-touch has-shadow" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a href="../index.html" title="OpenFF Sphinx theme" class="navbar-item is-hidden-mobile">
        
          <img src="../_static/images/logos/openforcefield_v1_white.png" alt="OpenFF Sphinx theme logo">
        
      </a>
    </div>

    <div class="has-text-light is-hidden-mobile nav-title">
      <div class="breadcrumb">
  <ul>
        <li><a href="../index.html">OpenFF Sphinx theme</a></li>
      <li><a href="../numpydoc.html">Openff-toolkit example</a></li>
      <li class="is-active"><a href="#">openff.toolkit.topology.Molecule</a></li>
  </ul>
</div>
    </div>
    <div class="has-text-light is-hidden-tablet nav-title">
      <span> openff.toolkit.topology.Molecule </span>
    </div>

    <div class="navbar-end">
      <span class="navbar-item nav-search is-hidden-mobile">
        
<form action="../search.html" method="GET" name="search">
  <div class="control has-icons-right">
    <span class="icon is-small is-right">
      <i class="fas fa-search"></i>
    </span>
    <input class="input is-primary" type="text"  name="q" placeholder="Search"
         autocapitalize="off" autocomplete="off" spellcheck="false">
  </div>
</form>

      </span>
      
        <a href="https://github.com/openforcefield/openff-sphinx-theme/" class="is-family-monospace navbar-item is-hidden-touch has-text-light">
          
          <span class="icon-text">
            <span class="icon">
              <i class="fab fa-github"></i>
            </span>
            <span>
          
            openff-sphinx-theme
          
            </span>
          </span>
          
        </a>
      
      <a href="https://openforcefield.org/" class="navbar-item is-hidden-touch">
        <img
          src="../_static/images/logos/openforcefield_v2_white.png"
          alt="Open Force Field Initiative logo"
        >
      </a>
    </div>
    <span class="navbar-burger-spacer is-hidden-desktop"></span>
  </nav>

  

  <div class="level is-hidden-mobile nav-tabs">
      
      <div class="level-item has-text-centered"><a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div>
      
      <div class="level-item has-text-centered"><a href="https://bashtage.github.io/sphinx-material/">Material for Sphinx</a></div>
      
      <div class="level-item has-text-centered"><a href="https://openforcefield.org">The OpenFF Initiative</a></div>
      
      <div class="level-item has-text-centered"><a href="https://github.com/openforcefield/openff-sphinx-theme/">openff-sphinx-theme on GitHub</a></div>
  </div>

</header>

  
  <main class="mb-6">
      <div class="columns">
        <input type="checkbox" id="drawer-toggle" class="is-hidden">
        <label for="drawer-toggle" role="button" class="navbar-burger burger is-light">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </label>

        <aside class="column is-2" id="drawer">
          <div class="is-hidden-tablet">
            <a href="../index.html" title="OpenFF Sphinx theme">
              <h1>
                OpenFF Sphinx theme
              </h1>
            </a>
            <div class="py-3">
              
<form action="../search.html" method="GET" name="search">
  <div class="control has-icons-right">
    <span class="icon is-small is-right">
      <i class="fas fa-search"></i>
    </span>
    <input class="input is-primary" type="text"  name="q" placeholder="Search"
         autocapitalize="off" autocomplete="off" spellcheck="false">
  </div>
</form>

            </div>
          </div>
          

<nav class="menu ff-globaltoc">
  
    
      
      <p class="menu-label"><span class="caption-text">Basic Use</span></p>
      <ul class="menu-list">
    
    
      
      <li>
        <a href="../customization.html" class="">Customization</a>
      </li>
      
    
    
      
      <li>
        <a href="../specimen.html" class="">Specimen</a>
      </li>
      
    
    
      
      <li>
        <a href="../additional_samples.html" class=""><code class="docutils literal notranslate"><span class="pre">Additional</span> <span class="pre">Samples</span></code></a>
      </li>
      
    
    
      
        </ul>
      
      <p class="menu-label"><span class="caption-text">Other Examples and Uses</span></p>
      <ul class="menu-list">
    
    
      
      <li>
        <a href="../pymethod.html" class="">Python Methods</a>
      </li>
      
    
    
      
      <li>
        <a href="../numpydoc_example.html" class="">NumPy Docstrings</a>
      </li>
      
    
    
      
      <li>
        <a href="../autodoc_pydantic_example.html" class="">autodoc_pydantic API Docs</a>
      </li>
      
    
    
      
      <li>
        <a href="../numpydoc.html" class="">Openff-toolkit example</a>
      </li>
      
    
    
      
      <li>
        <a href="../pydantic.html" class="">Pydantic API docs</a>
      </li>
      
    
    
      
      <li>
        <a href="../notebook.html" class="">Jupyter Notebooks</a>
      </li>
      
    
    
      
      <li>
        <a href="../markdown.html" class="">Markdown</a>
      </li>
      
    
    
      
      <li>
        <a href="../rst-cheatsheet/rst-cheatsheet.html" class="">rst Cheatsheet</a>
      </li>
      
    
    
      
      <li>
        <a href="../primer.html" class="">reStructuredText Primer</a>
      </li>
      
    
    
      
        </ul>
      
      <p class="menu-label"><span class="caption-text">Changes and License</span></p>
      <ul class="menu-list">
    
    
      
      <li>
        <a href="../change-log.html" class="">Change Log</a>
      </li>
      
    
    
      
      <li>
        <a href="../license.html" class="">License</a>
      </li>
      
        </ul>
      
    
  </ul>
</nav>

        </aside>

        <div class="column is-8-desktop is-9-tablet">
          <article class="content">
            
  <section id="openff-toolkit-topology-molecule">
<h1>openff.toolkit.topology.Molecule<a class="headerlink" href="#openff-toolkit-topology-molecule" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">openff.toolkit.topology.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Mutable chemical representation of a molecule, such as a small molecule or biopolymer.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>What other API calls would be useful for supporting biopolymers as small molecules? Perhaps iterating over chains and residues?</p>
</div>
<p class="rubric">Examples</p>
<p>Create a molecule from an sdf file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;molecules/ethanol.sdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to OpenEye OEMol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_openeye</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an OpenEye molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_openeye</span><span class="p">(</span><span class="n">oemol</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to RDKit Mol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an RDKit molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_rdkit</span><span class="p">(</span><span class="n">rdmol</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from IUPAC name (requires the OpenEye toolkit)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;imatinib&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from SMILES</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;Cc1ccccc1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
</dd></dl>

<section class="imitate-nested-in-previous-deflist hide-header" id="init">
<h2><code class="docutils literal notranslate"><span class="pre">__init__</span></code><a class="headerlink" href="#init" title="Permalink to this headline">¶</a></h2>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.__init__">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new Molecule object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong><span class="classifier">optional, default=None</span></dt><dd><p>If specified, attempt to construct a copy of the Molecule from the
specified object. This can be any one of the following:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p></li>
<li><p>a file that can be used to construct a <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p></li>
<li><p>an <code class="docutils literal notranslate"><span class="pre">openeye.oechem.OEMol</span></code></p></li>
<li><p>an <code class="docutils literal notranslate"><span class="pre">rdkit.Chem.rdchem.Mol</span></code></p></li>
<li><p>a serialized <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create an empty molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">empty_molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from a file that can be used to construct a molecule,
using either a filename or file-like object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;molecules/ethanol.sdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">),</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;sdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol2_gz_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;molecules/toluene.mol2.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">gzip</span><span class="o">.</span><span class="n">GzipFile</span><span class="p">(</span><span class="n">mol2_gz_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">),</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;mol2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from another molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule_copy</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to OpenEye OEMol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_openeye</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an OpenEye molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">oemol</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to RDKit Mol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an RDKit molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">rdmol</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from a serialized molecule object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">serialized_molecule</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule_copy</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">serialized_molecule</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>If a filename or file-like object is specified but the file
contains more than one molecule, what is the proper behavior?
Read just the first molecule, or raise an exception if more
than one molecule is found?</p></li>
<li><p>Should we also support SMILES strings or IUPAC names for
<code class="docutils literal notranslate"><span class="pre">other</span></code>?</p></li>
</ul>
</div>
</dd></dl>

</section>
<section class="imitate-nested-in-previous-deflist" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.__init__" title="openff.toolkit.topology.Molecule.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(*args, **kwargs)</p></td>
<td><p>Create a new Molecule object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_atom" title="openff.toolkit.topology.Molecule.add_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atom</span></code></a>(atomic_number, formal_charge, …)</p></td>
<td><p>Add an atom</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_bond" title="openff.toolkit.topology.Molecule.add_bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bond</span></code></a>(atom1, atom2, bond_order, is_aromatic)</p></td>
<td><p>Add a bond between two specified atom indices</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_bond_charge_virtual_site" title="openff.toolkit.topology.Molecule.add_bond_charge_virtual_site"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bond_charge_virtual_site</span></code></a>(atoms, …)</p></td>
<td><p>Add a virtual site representing the charge on a bond.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_conformer" title="openff.toolkit.topology.Molecule.add_conformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_conformer</span></code></a>(coordinates)</p></td>
<td><p>Add a conformation of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_divalent_lone_pair_virtual_site" title="openff.toolkit.topology.Molecule.add_divalent_lone_pair_virtual_site"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_divalent_lone_pair_virtual_site</span></code></a>(atoms, …)</p></td>
<td><p>Create a divalent lone pair-type virtual site, in which the location of the charge is specified by the position of three atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_monovalent_lone_pair_virtual_site" title="openff.toolkit.topology.Molecule.add_monovalent_lone_pair_virtual_site"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_monovalent_lone_pair_virtual_site</span></code></a>(atoms, …)</p></td>
<td><p>Create a bond charge-type virtual site, in which the location of the charge is specified by the position of three atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_trivalent_lone_pair_virtual_site" title="openff.toolkit.topology.Molecule.add_trivalent_lone_pair_virtual_site"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_trivalent_lone_pair_virtual_site</span></code></a>(atoms, …)</p></td>
<td><p>Create a trivalent lone pair-type virtual site, in which the location of the charge is specified by the position of four atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.apply_elf_conformer_selection" title="openff.toolkit.topology.Molecule.apply_elf_conformer_selection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_elf_conformer_selection</span></code></a>([percentage, …])</p></td>
<td><p>Applies the <a class="reference external" href="https://docs.eyesopen.com/toolkits/python/quacpactk/molchargetheory.html#elf-conformer-selection">ELF method</a> to select a set of diverse conformers which have minimal electrostatically strongly interacting functional groups from a molecules conformers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.are_isomorphic" title="openff.toolkit.topology.Molecule.are_isomorphic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">are_isomorphic</span></code></a>(mol1, mol2[, …])</p></td>
<td><p>Determines whether the two molecules are isomorphic by comparing their graph representations and the chosen node/edge attributes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.assign_fractional_bond_orders" title="openff.toolkit.topology.Molecule.assign_fractional_bond_orders"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_fractional_bond_orders</span></code></a>([…])</p></td>
<td><p>Update and store list of bond orders this molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.assign_partial_charges" title="openff.toolkit.topology.Molecule.assign_partial_charges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_partial_charges</span></code></a>(partial_charge_method)</p></td>
<td><p>Calculate partial atomic charges for this molecule using an underlying toolkit, and assign the new values to the partial_charges attribute.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.canonical_order_atoms" title="openff.toolkit.topology.Molecule.canonical_order_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">canonical_order_atoms</span></code></a>([toolkit_registry])</p></td>
<td><p>Canonical order the atoms in a copy of the molecule using a toolkit, returns a new copy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.chemical_environment_matches" title="openff.toolkit.topology.Molecule.chemical_environment_matches"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chemical_environment_matches</span></code></a>(query[, …])</p></td>
<td><p>Retrieve all matches for a given chemical environment query.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.compute_partial_charges_am1bcc" title="openff.toolkit.topology.Molecule.compute_partial_charges_am1bcc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_partial_charges_am1bcc</span></code></a>([…])</p></td>
<td><p>Calculate partial atomic charges for this molecule using AM1-BCC run by an underlying toolkit and assign them to this molecule’s partial_charges attribute.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.enumerate_protomers" title="openff.toolkit.topology.Molecule.enumerate_protomers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enumerate_protomers</span></code></a>([max_states])</p></td>
<td><p>Enumerate the formal charges of a molecule to generate different protomoers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.enumerate_stereoisomers" title="openff.toolkit.topology.Molecule.enumerate_stereoisomers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enumerate_stereoisomers</span></code></a>([undefined_only, …])</p></td>
<td><p>Enumerate the stereocenters and bonds of the current molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.enumerate_tautomers" title="openff.toolkit.topology.Molecule.enumerate_tautomers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enumerate_tautomers</span></code></a>([max_states, …])</p></td>
<td><p>Enumerate the possible tautomers of the current molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.find_rotatable_bonds" title="openff.toolkit.topology.Molecule.find_rotatable_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_rotatable_bonds</span></code></a>([…])</p></td>
<td><p>Find all bonds classed as rotatable ignoring any matched to the <code class="docutils literal notranslate"><span class="pre">ignore_functional_groups</span></code> list.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_bson" title="openff.toolkit.topology.Molecule.from_bson"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_bson</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a BSON serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_dict" title="openff.toolkit.topology.Molecule.from_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_dict</span></code></a>(molecule_dict)</p></td>
<td><p>Create a new Molecule from a dictionary representation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_file" title="openff.toolkit.topology.Molecule.from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_file</span></code></a>(file_path[, file_format, …])</p></td>
<td><p>Create one or more molecules from a file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_inchi" title="openff.toolkit.topology.Molecule.from_inchi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_inchi</span></code></a>(inchi[, allow_undefined_stereo, …])</p></td>
<td><p>Construct a Molecule from a InChI representation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_iupac" title="openff.toolkit.topology.Molecule.from_iupac"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_iupac</span></code></a>(iupac_name[, toolkit_registry, …])</p></td>
<td><p>Generate a molecule from IUPAC or common name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_json" title="openff.toolkit.topology.Molecule.from_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_json</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a JSON serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="openff.toolkit.topology.Molecule.from_mapped_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_mapped_smiles</span></code></a>(mapped_smiles[, …])</p></td>
<td><p>Create an openff.toolkit.topology.molecule.Molecule from a mapped SMILES made with cmiles.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_messagepack" title="openff.toolkit.topology.Molecule.from_messagepack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_messagepack</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a MessagePack serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_openeye" title="openff.toolkit.topology.Molecule.from_openeye"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_openeye</span></code></a>(oemol[, allow_undefined_stereo])</p></td>
<td><p>Create a Molecule from an OpenEye molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_pdb_and_smiles" title="openff.toolkit.topology.Molecule.from_pdb_and_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_pdb_and_smiles</span></code></a>(file_path, smiles[, …])</p></td>
<td><p>Create a Molecule from a pdb file and a SMILES string using RDKit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_pickle" title="openff.toolkit.topology.Molecule.from_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_pickle</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a pickle serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_qcschema" title="openff.toolkit.topology.Molecule.from_qcschema"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_qcschema</span></code></a>(qca_record[, client, …])</p></td>
<td><p>Create a Molecule from a QCArchive molecule record or dataset entry based on attached cmiles information.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_rdkit" title="openff.toolkit.topology.Molecule.from_rdkit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_rdkit</span></code></a>(rdmol[, allow_undefined_stereo, …])</p></td>
<td><p>Create a Molecule from an RDKit molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_smiles" title="openff.toolkit.topology.Molecule.from_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_smiles</span></code></a>(smiles[, …])</p></td>
<td><p>Construct a Molecule from a SMILES representation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_toml" title="openff.toolkit.topology.Molecule.from_toml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_toml</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a TOML serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_topology" title="openff.toolkit.topology.Molecule.from_topology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_topology</span></code></a>(topology)</p></td>
<td><p>Return a Molecule representation of an OpenFF Topology containing a single Molecule object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_xml" title="openff.toolkit.topology.Molecule.from_xml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_xml</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from an XML serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_yaml" title="openff.toolkit.topology.Molecule.from_yaml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_yaml</span></code></a>(serialized)</p></td>
<td><p>Instantiate from a YAML serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.generate_conformers" title="openff.toolkit.topology.Molecule.generate_conformers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_conformers</span></code></a>([toolkit_registry, …])</p></td>
<td><p>Generate conformers for this molecule using an underlying toolkit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.generate_unique_atom_names" title="openff.toolkit.topology.Molecule.generate_unique_atom_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_unique_atom_names</span></code></a>()</p></td>
<td><p>Generate unique atom names using element name and number of times that element has occurred e.g.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.get_bond_between" title="openff.toolkit.topology.Molecule.get_bond_between"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_between</span></code></a>(i, j)</p></td>
<td><p>Returns the bond between two atoms</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.is_isomorphic_with" title="openff.toolkit.topology.Molecule.is_isomorphic_with"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_isomorphic_with</span></code></a>(other, **kwargs)</p></td>
<td><p>Check if the molecule is isomorphic with the other molecule which can be an openff.toolkit.topology.Molecule, or TopologyMolecule or nx.Graph().</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.remap" title="openff.toolkit.topology.Molecule.remap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remap</span></code></a>(mapping_dict[, current_to_new])</p></td>
<td><p>Remap all of the indexes in the molecule to match the given mapping dict</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.strip_atom_stereochemistry" title="openff.toolkit.topology.Molecule.strip_atom_stereochemistry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">strip_atom_stereochemistry</span></code></a>(smarts[, …])</p></td>
<td><p>Delete stereochemistry information for certain atoms, if it is present.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_bson" title="openff.toolkit.topology.Molecule.to_bson"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_bson</span></code></a>()</p></td>
<td><p>Return a BSON serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_dict" title="openff.toolkit.topology.Molecule.to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dict</span></code></a>()</p></td>
<td><p>Return a dictionary representation of the molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_file" title="openff.toolkit.topology.Molecule.to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_file</span></code></a>(file_path, file_format[, …])</p></td>
<td><p>Write the current molecule to a file or file-like object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_hill_formula" title="openff.toolkit.topology.Molecule.to_hill_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_hill_formula</span></code></a>(molecule)</p></td>
<td><p>Generate the Hill formula from either a FrozenMolecule, TopologyMolecule or nx.Graph() of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_inchi" title="openff.toolkit.topology.Molecule.to_inchi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_inchi</span></code></a>([fixed_hydrogens, toolkit_registry])</p></td>
<td><p>Create an InChI string for the molecule using the requested toolkit backend.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_inchikey" title="openff.toolkit.topology.Molecule.to_inchikey"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_inchikey</span></code></a>([fixed_hydrogens, toolkit_registry])</p></td>
<td><p>Create an InChIKey for the molecule using the requested toolkit backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_iupac" title="openff.toolkit.topology.Molecule.to_iupac"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_iupac</span></code></a>([toolkit_registry])</p></td>
<td><p>Generate IUPAC name from Molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_json" title="openff.toolkit.topology.Molecule.to_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_json</span></code></a>([indent])</p></td>
<td><p>Return a JSON serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_messagepack" title="openff.toolkit.topology.Molecule.to_messagepack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_messagepack</span></code></a>()</p></td>
<td><p>Return a MessagePack representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_networkx" title="openff.toolkit.topology.Molecule.to_networkx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_networkx</span></code></a>()</p></td>
<td><p>Generate a NetworkX undirected graph from the Molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_openeye" title="openff.toolkit.topology.Molecule.to_openeye"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_openeye</span></code></a>([aromaticity_model])</p></td>
<td><p>Create an OpenEye molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_pickle" title="openff.toolkit.topology.Molecule.to_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_pickle</span></code></a>()</p></td>
<td><p>Return a pickle serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_qcschema" title="openff.toolkit.topology.Molecule.to_qcschema"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_qcschema</span></code></a>([multiplicity, conformer, extras])</p></td>
<td><p>Create a QCElemental Molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_rdkit" title="openff.toolkit.topology.Molecule.to_rdkit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_rdkit</span></code></a>([aromaticity_model])</p></td>
<td><p>Create an RDKit molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_smiles" title="openff.toolkit.topology.Molecule.to_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_smiles</span></code></a>([isomeric, explicit_hydrogens, …])</p></td>
<td><p>Return a canonical isomeric SMILES representation of the current molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_toml" title="openff.toolkit.topology.Molecule.to_toml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_toml</span></code></a>()</p></td>
<td><p>Return a TOML serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_topology" title="openff.toolkit.topology.Molecule.to_topology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_topology</span></code></a>()</p></td>
<td><p>Return an OpenFF Topology representation containing one copy of this molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_xml" title="openff.toolkit.topology.Molecule.to_xml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_xml</span></code></a>([indent])</p></td>
<td><p>Return an XML representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_yaml" title="openff.toolkit.topology.Molecule.to_yaml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_yaml</span></code></a>()</p></td>
<td><p>Return a YAML serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.visualize" title="openff.toolkit.topology.Molecule.visualize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize</span></code></a>([backend, width, height])</p></td>
<td><p>Render a visualization of the molecule in Jupyter</p></td>
</tr>
</tbody>
</table>
<section class="hide-header" id="add-atom">
<h3><code class="docutils literal notranslate"><span class="pre">add_atom</span></code><a class="headerlink" href="#add-atom" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_atom">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomic_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formal_charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_aromatic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereochemistry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an atom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atomic_number</strong><span class="classifier">int</span></dt><dd><p>Atomic number of the atom</p>
</dd>
<dt><strong>formal_charge</strong><span class="classifier">int</span></dt><dd><p>Formal charge of the atom</p>
</dd>
<dt><strong>is_aromatic</strong><span class="classifier">bool</span></dt><dd><p>If True, atom is aromatic; if False, not aromatic</p>
</dd>
<dt><strong>stereochemistry</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Either ‘R’ or ‘S’ for specified stereochemistry, or None if stereochemistry is irrelevant</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>An optional name for the atom</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the atom in the molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Define a methane molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;methane&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H1</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H2</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H3</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H4</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H1</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H3</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H4</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="add-bond">
<h3><code class="docutils literal notranslate"><span class="pre">add_bond</span></code><a class="headerlink" href="#add-bond" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_bond">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_aromatic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereochemistry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fractional_bond_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond between two specified atom indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom1</strong><span class="classifier">int or openff.toolkit.topology.molecule.Atom</span></dt><dd><p>Index of first atom</p>
</dd>
<dt><strong>atom2</strong><span class="classifier">int or openff.toolkit.topology.molecule.Atom</span></dt><dd><p>Index of second atom</p>
</dd>
<dt><strong>bond_order</strong><span class="classifier">int</span></dt><dd><p>Integral bond order of Kekulized form</p>
</dd>
<dt><strong>is_aromatic</strong><span class="classifier">bool</span></dt><dd><p>True if this bond is aromatic, False otherwise</p>
</dd>
<dt><strong>stereochemistry</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Either ‘E’ or ‘Z’ for specified stereochemistry, or None if stereochemistry is irrelevant</p>
</dd>
<dt><strong>fractional_bond_order</strong><span class="classifier">float, optional, default=None</span></dt><dd><p>The fractional (eg. Wiberg) bond order</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>index: int</dt><dd><p>Index of the bond in this molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="add-bond-charge-virtual-site">
<h3><code class="docutils literal notranslate"><span class="pre">add_bond_charge_virtual_site</span></code><a class="headerlink" href="#add-bond-charge-virtual-site" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_bond_charge_virtual_site">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_bond_charge_virtual_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_bond_charge_virtual_site"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_bond_charge_virtual_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a virtual site representing the charge on a bond.</p>
<p>Create a bond charge-type virtual site, in which the location of the
charge is specified by the position of two atoms. This supports
placement of a virtual site S along a vector between two specified
atoms, e.g. to allow for a sigma hole for halogens or similar contexts.
With positive values of the distance, the virtual site lies outside the
first indexed atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atoms</strong><span class="classifier">list of openff.toolkit.topology.molecule.Atom objects or ints of shape [N]</span></dt><dd><p>The atoms defining the virtual site’s position or their indices</p>
</dd>
<dt><strong>distance</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>weights</strong><span class="classifier">list of floats of shape [N] or None, optional, default=None</span></dt><dd><p>weights[index] is the weight of particles[index] contributing to
the position of the virtual site. Default is None</p>
</dd>
<dt><strong>charge_increments</strong><span class="classifier">list of floats of shape [N], optional, default=None</span></dt><dd><p>The amount of charge to remove from the VirtualSite’s atoms and put
in the VirtualSite. Indexing in this list should match the ordering
in the atoms list. Default is None.</p>
</dd>
<dt><strong>epsilon</strong><span class="classifier">float</span></dt><dd><p>Epsilon term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float, default=None</span></dt><dd><p>Sigma term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>rmin_half</strong><span class="classifier">float</span></dt><dd><p>Rmin_half term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>name</strong><span class="classifier">string or None, default=’’</span></dt><dd><p>The name of this virtual site. Default is ‘’.</p>
</dd>
<dt><strong>symmetric</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to make virtual site symmetric by creating two particles
instead of just one. As an example, for N_2 this should be set to
True to model both lone pairs with the same parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the newly-added virtual site in the molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="add-conformer">
<h3><code class="docutils literal notranslate"><span class="pre">add_conformer</span></code><a class="headerlink" href="#add-conformer" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_conformer">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_conformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_conformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_conformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a conformation of the molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates: simtk.unit.Quantity(np.array) with shape (n_atoms, 3) and dimension of distance</strong></dt><dd><p>Coordinates of the new conformer, with the first dimension of the array corresponding to the atom index in
the Molecule’s indexing system.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>index: int</dt><dd><p>The index of this conformer</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="add-divalent-lone-pair-virtual-site">
<h3><code class="docutils literal notranslate"><span class="pre">add_divalent_lone_pair_virtual_site</span></code><a class="headerlink" href="#add-divalent-lone-pair-virtual-site" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_divalent_lone_pair_virtual_site">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_divalent_lone_pair_virtual_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_of_plane_angle</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_divalent_lone_pair_virtual_site"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_divalent_lone_pair_virtual_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a divalent lone pair-type virtual site, in which the location of the charge is specified by the position of three atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atoms</strong><span class="classifier">list of 3 openff.toolkit.topology.molecule.Atom objects or ints</span></dt><dd><p>The three atoms defining the virtual site’s position or their molecule atom indices</p>
</dd>
<dt><strong>distance</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>out_of_plane_angle</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>epsilon</strong><span class="classifier">float</span></dt><dd><p>Epsilon term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float, default=None</span></dt><dd><p>Sigma term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>rmin_half</strong><span class="classifier">float</span></dt><dd><p>Rmin_half term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>name</strong><span class="classifier">string or None, default=’’</span></dt><dd><p>The name of this virtual site. Default is ‘’.</p>
</dd>
<dt><strong>symmetric</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to make virtual site symmetric by creating two particles
instead of just one. As an example, for TIP5 should be set to True
to model both lone pairs with the same parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the newly-added virtual site in the molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="add-monovalent-lone-pair-virtual-site">
<h3><code class="docutils literal notranslate"><span class="pre">add_monovalent_lone_pair_virtual_site</span></code><a class="headerlink" href="#add-monovalent-lone-pair-virtual-site" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_monovalent_lone_pair_virtual_site">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_monovalent_lone_pair_virtual_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_of_plane_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_plane_angle</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_monovalent_lone_pair_virtual_site"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_monovalent_lone_pair_virtual_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a bond charge-type virtual site, in which the location of the charge is specified by the position of three atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atoms</strong><span class="classifier">list of three openff.toolkit.topology.molecule.Atom objects or ints</span></dt><dd><p>The three atoms defining the virtual site’s position or their molecule atom indices</p>
</dd>
<dt><strong>distance</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>out_of_plane_angle</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>in_plane_angle</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>epsilon</strong><span class="classifier">float</span></dt><dd><p>Epsilon term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float, default=None</span></dt><dd><p>Sigma term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>rmin_half</strong><span class="classifier">float</span></dt><dd><p>Rmin_half term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>name</strong><span class="classifier">string or None, default=’’</span></dt><dd><p>The name of this virtual site. Default is ‘’.</p>
</dd>
<dt><strong>symmetric</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to make virtual site symmetric by creating two particles
instead of just one. Note that because this site is defined is placed
on the noncentral atom, setting this to True will place one particle
on atom1, and the other on atom3.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the newly-added virtual site in the molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="add-trivalent-lone-pair-virtual-site">
<h3><code class="docutils literal notranslate"><span class="pre">add_trivalent_lone_pair_virtual_site</span></code><a class="headerlink" href="#add-trivalent-lone-pair-virtual-site" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_trivalent_lone_pair_virtual_site">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">add_trivalent_lone_pair_virtual_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_trivalent_lone_pair_virtual_site"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_trivalent_lone_pair_virtual_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a trivalent lone pair-type virtual site, in which the location of the charge is specified by the position of four atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atoms</strong><span class="classifier">list of 4 openff.toolkit.topology.molecule.Atom objects or ints</span></dt><dd><p>The three atoms defining the virtual site’s position or their molecule atom indices</p>
</dd>
<dt><strong>distance</strong><span class="classifier">float</span></dt><dd></dd>
<dt><strong>epsilon</strong><span class="classifier">float</span></dt><dd><p>Epsilon term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float, default=None</span></dt><dd><p>Sigma term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>rmin_half</strong><span class="classifier">float</span></dt><dd><p>Rmin_half term for VdW properties of virtual site. Default is None.</p>
</dd>
<dt><strong>name</strong><span class="classifier">string or None, default=’’</span></dt><dd><p>The name of this virtual site. Default is ‘’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the newly-added virtual site in the molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="apply-elf-conformer-selection">
<h3><code class="docutils literal notranslate"><span class="pre">apply_elf_conformer_selection</span></code><a class="headerlink" href="#apply-elf-conformer-selection" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.apply_elf_conformer_selection">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">apply_elf_conformer_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">percentage:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">2.0</span></em>, <em class="sig-param"><span class="pre">limit:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></em>, <em class="sig-param"><span class="pre">toolkit_registry:</span> <span class="pre">Optional[Union[openff.toolkit.utils.toolkits.ToolkitRegistry</span></em>, <em class="sig-param"><span class="pre">openff.toolkit.utils.toolkits.ToolkitWrapper]]</span> <span class="pre">=</span> <span class="pre">ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.apply_elf_conformer_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the <a class="reference external" href="https://docs.eyesopen.com/toolkits/python/quacpactk/molchargetheory.html#elf-conformer-selection">ELF method</a>
to select a set of diverse conformers which have minimal
electrostatically strongly interacting functional groups from a
molecules conformers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong></dt><dd><p>The underlying toolkit to use to select the ELF conformers.</p>
</dd>
<dt><strong>percentage</strong></dt><dd><p>The percentage of conformers with the lowest electrostatic
interaction energies to greedily select from.</p>
</dd>
<dt><strong>limit</strong></dt><dd><p>The maximum number of conformers to select.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">OpenEyeToolkitWrapper.apply_elf_conformer_selection</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">RDKitToolkitWrapper.apply_elf_conformer_selection</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The input molecule should have a large set of conformers already
generated to select the ELF conformers from.</p></li>
<li><p>The selected conformers will be retained in the <cite>conformers</cite> list
while unselected conformers will be discarded.</p></li>
</ul>
</dd></dl>

</section>
<section class="hide-header" id="are-isomorphic">
<h3><code class="docutils literal notranslate"><span class="pre">are_isomorphic</span></code><a class="headerlink" href="#are-isomorphic" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.are_isomorphic">
<em class="property"><span class="pre">static</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">are_isomorphic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">mol1</span></em>, <em class="sig-param"><span class="pre">mol2</span></em>, <em class="sig-param"><span class="pre">return_atom_map=False</span></em>, <em class="sig-param"><span class="pre">aromatic_matching=True</span></em>, <em class="sig-param"><span class="pre">formal_charge_matching=True</span></em>, <em class="sig-param"><span class="pre">bond_order_matching=True</span></em>, <em class="sig-param"><span class="pre">atom_stereochemistry_matching=True</span></em>, <em class="sig-param"><span class="pre">bond_stereochemistry_matching=True</span></em>, <em class="sig-param"><span class="pre">strip_pyrimidal_n_atom_stereo=True</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.are_isomorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines whether the two molecules are isomorphic by comparing their graph representations and the chosen
node/edge attributes. Minimally connections and atomic_number are checked.</p>
<p>If nx.Graphs() are given they must at least have atomic_number attributes on nodes.
other optional attributes for nodes are: is_aromatic, formal_charge and stereochemistry.
optional attributes for edges are: is_aromatic, bond_order and stereochemistry.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mol1</strong><span class="classifier">an openff.toolkit.topology.molecule.FrozenMolecule or TopologyMolecule or nx.Graph()</span></dt><dd></dd>
<dt><strong>mol2</strong><span class="classifier">an openff.toolkit.topology.molecule.FrozenMolecule or TopologyMolecule or nx.Graph()</span></dt><dd><p>The molecule to test for isomorphism.</p>
</dd>
<dt><strong>return_atom_map: bool, default=False, optional</strong></dt><dd><p>will return an optional dict containing the atomic mapping.</p>
</dd>
<dt><strong>aromatic_matching: bool, default=True, optional</strong></dt><dd><p>compare the aromatic attributes of bonds and atoms.</p>
</dd>
<dt><strong>formal_charge_matching: bool, default=True, optional</strong></dt><dd><p>compare the formal charges attributes of the atoms.</p>
</dd>
<dt><strong>bond_order_matching: bool, deafult=True, optional</strong></dt><dd><p>compare the bond order on attributes of the bonds.</p>
</dd>
<dt><strong>atom_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, atoms’ stereochemistry is ignored for the
purpose of determining equality.</p>
</dd>
<dt><strong>bond_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, bonds’ stereochemistry is ignored for the
purpose of determining equality.</p>
</dd>
<dt><strong>strip_pyrimidal_n_atom_stereo: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, any stereochemistry defined around pyrimidal
nitrogen stereocenters will be disregarded in the isomorphism
check.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for
removing stereochemistry from pyrimidal nitrogens.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecules_are_isomorphic</strong><span class="classifier">bool</span></dt><dd></dd>
<dt><strong>atom_map</strong><span class="classifier">default=None, Optional,</span></dt><dd><p>[Dict[int,int]] ordered by mol1 indexing {mol1_index: mol2_index}
If molecules are not isomorphic given input arguments, will return None instead of dict.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="assign-fractional-bond-orders">
<h3><code class="docutils literal notranslate"><span class="pre">assign_fractional_bond_orders</span></code><a class="headerlink" href="#assign-fractional-bond-orders" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.assign_fractional_bond_orders">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">assign_fractional_bond_orders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">bond_order_model=None</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">use_conformers=None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.assign_fractional_bond_orders" title="Permalink to this definition">¶</a></dt>
<dd><p>Update and store list of bond orders this molecule. Bond orders are stored on each
bond, in the <cite>bond.fractional_bond_order</cite> attribute.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>bond_order_model</strong><span class="classifier">string, optional. Default=None</span></dt><dd><p>The bond order model to use for fractional bond order calculation. If None, “am1-wiberg” will be used.</p>
</dd>
<dt><strong>use_conformers</strong><span class="classifier">iterable of simtk.unit.Quantity(np.array) with shape (n_atoms, 3) and dimension of distance, optional, default=None</span></dt><dd><p>The conformers to use for fractional bond order calculation. If None, an appropriate number
of conformers will be generated by an available ToolkitWrapper.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;CCCCCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">assign_fractional_bond_orders</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="assign-partial-charges">
<h3><code class="docutils literal notranslate"><span class="pre">assign_partial_charges</span></code><a class="headerlink" href="#assign-partial-charges" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.assign_partial_charges">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">assign_partial_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">partial_charge_method</span></em>, <em class="sig-param"><span class="pre">strict_n_conformers=False</span></em>, <em class="sig-param"><span class="pre">use_conformers=None</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.assign_partial_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate partial atomic charges for this molecule using an underlying toolkit, and assign
the new values to the partial_charges attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>partial_charge_method</strong><span class="classifier">string</span></dt><dd><p>The partial charge calculation method to use for partial charge calculation.</p>
</dd>
<dt><strong>strict_n_conformers</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to raise an exception if an invalid number of conformers is provided for the given charge method.
If this is False and an invalid number of conformers is found, a warning will be raised.</p>
</dd>
<dt><strong>use_conformers</strong><span class="classifier">iterable of simtk.unit.Quantity-wrapped numpy arrays, each with shape (n_atoms, 3) and dimension of distance. Optional, default=None</span></dt><dd><p>Coordinates to use for partial charge calculation. If None, an appropriate number of conformers will be generated.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for the calculation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;CCCCCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">assign_partial_charges</span><span class="p">(</span><span class="s1">&#39;am1-mulliken&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="canonical-order-atoms">
<h3><code class="docutils literal notranslate"><span class="pre">canonical_order_atoms</span></code><a class="headerlink" href="#canonical-order-atoms" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.canonical_order_atoms">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">canonical_order_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.canonical_order_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Canonical order the atoms in a copy of the molecule using a toolkit, returns a new copy.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An new OpenFF style molecule with atoms in the canonical order.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="chemical-environment-matches">
<h3><code class="docutils literal notranslate"><span class="pre">chemical_environment_matches</span></code><a class="headerlink" href="#chemical-environment-matches" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.chemical_environment_matches">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">chemical_environment_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">query</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.chemical_environment_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all matches for a given chemical environment query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>query</strong><span class="classifier">str or ChemicalEnvironment</span></dt><dd><p>SMARTS string (with one or more tagged atoms) or <code class="docutils literal notranslate"><span class="pre">ChemicalEnvironment</span></code> query
Query will internally be resolved to SMIRKS using <code class="docutils literal notranslate"><span class="pre">query.asSMIRKS()</span></code> if it has an <code class="docutils literal notranslate"><span class="pre">.asSMIRKS</span></code> method.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=GLOBAL_TOOLKIT_REGISTRY</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for chemical environment matches</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>matches</strong><span class="classifier">list of atom index tuples</span></dt><dd><p>A list of tuples, containing the indices of the matching atoms.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Retrieve all the carbon-carbon bond matches in a molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;imatinib&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">chemical_environment_matches</span><span class="p">(</span><span class="s1">&#39;[#6X3:1]~[#6X3:2]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we want to generalize <code class="docutils literal notranslate"><span class="pre">query</span></code> to allow other kinds of queries, such as mdtraj DSL, pymol selections, atom index slices, etc?
We could call it <code class="docutils literal notranslate"><span class="pre">topology.matches(query)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">chemical_environment_matches</span></code></p></li>
</ul>
</div>
</dd></dl>

</section>
<section class="hide-header" id="compute-partial-charges-am1bcc">
<h3><code class="docutils literal notranslate"><span class="pre">compute_partial_charges_am1bcc</span></code><a class="headerlink" href="#compute-partial-charges-am1bcc" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.compute_partial_charges_am1bcc">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">compute_partial_charges_am1bcc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">use_conformers=None</span></em>, <em class="sig-param"><span class="pre">strict_n_conformers=False</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.compute_partial_charges_am1bcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate partial atomic charges for this molecule using AM1-BCC run by an underlying toolkit
and assign them to this molecule’s partial_charges attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>strict_n_conformers</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to raise an exception if an invalid number of conformers is provided for the given charge method.
If this is False and an invalid number of conformers is found, a warning will be raised.</p>
</dd>
<dt><strong>use_conformers</strong><span class="classifier">iterable of simtk.unit.Quantity-wrapped numpy arrays, each with shape (n_atoms, 3) and dimension of distance. Optional, default=None</span></dt><dd><p>Coordinates to use for partial charge calculation.
If None, an appropriate number of conformers for the given charge method will be generated.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for the calculation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;CCCCCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">generate_conformers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">compute_partial_charges_am1bcc</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="enumerate-protomers">
<h3><code class="docutils literal notranslate"><span class="pre">enumerate_protomers</span></code><a class="headerlink" href="#enumerate-protomers" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.enumerate_protomers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">enumerate_protomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.enumerate_protomers" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate the formal charges of a molecule to generate different protomoers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_states: int optional, default=10,</strong></dt><dd><p>The maximum number of protomer states to be returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>molecules: List[openff.toolkit.topology.Molecule],</dt><dd><p>A list of the protomers of the input molecules not including the input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="enumerate-stereoisomers">
<h3><code class="docutils literal notranslate"><span class="pre">enumerate_stereoisomers</span></code><a class="headerlink" href="#enumerate-stereoisomers" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.enumerate_stereoisomers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">enumerate_stereoisomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">undefined_only=False</span></em>, <em class="sig-param"><span class="pre">max_isomers=20</span></em>, <em class="sig-param"><span class="pre">rationalise=True</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.enumerate_stereoisomers" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate the stereocenters and bonds of the current molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>undefined_only: bool optional, default=False</strong></dt><dd><p>If we should enumerate all stereocenters and bonds or only those with undefined stereochemistry</p>
</dd>
<dt><strong>max_isomers: int optional, default=20</strong></dt><dd><p>The maximum amount of molecules that should be returned</p>
</dd>
<dt><strong>rationalise: bool optional, default=True</strong></dt><dd><p>If we should try to build and rationalise the molecule to ensure it can exist</p>
</dd>
<dt><strong>toolkit_registry: openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper,</strong></dt><dd></dd>
<dt><strong>optional, default=GLOBAL_TOOLKIT_REGISTRY</strong></dt><dd><p><cite>ToolkitRegistry</cite> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use to enumerate the stereoisomers.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>molecules: List[openff.toolkit.topology.Molecule]</dt><dd><p>A list of openff.toolkit.topology.Molecule instances not including the input molecule.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="enumerate-tautomers">
<h3><code class="docutils literal notranslate"><span class="pre">enumerate_tautomers</span></code><a class="headerlink" href="#enumerate-tautomers" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.enumerate_tautomers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">enumerate_tautomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">max_states=20</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.enumerate_tautomers" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate the possible tautomers of the current molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_states: int optional, default=20</strong></dt><dd><p>The maximum amount of molecules that should be returned</p>
</dd>
<dt><strong>toolkit_registry: openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper,</strong></dt><dd></dd>
<dt><strong>optional, default=GLOBAL_TOOLKIT_REGISTRY</strong></dt><dd><p><cite>ToolkitRegistry</cite> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use to enumerate the tautomers.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>molecules: List[openff.toolkit.topology.Molecule]</dt><dd><p>A list of openff.toolkit.topology.Molecule instances not including the input molecule.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="find-rotatable-bonds">
<h3><code class="docutils literal notranslate"><span class="pre">find_rotatable_bonds</span></code><a class="headerlink" href="#find-rotatable-bonds" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.find_rotatable_bonds">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">find_rotatable_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ignore_functional_groups=None</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.find_rotatable_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all bonds classed as rotatable ignoring any matched to the <code class="docutils literal notranslate"><span class="pre">ignore_functional_groups</span></code> list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ignore_functional_groups: optional, List[str], default=None,</strong></dt><dd><p>A list of bond SMARTS patterns to be ignored when finding rotatable bonds.</p>
</dd>
<dt><strong>toolkit_registry: openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</strong></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMARTS matching</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bonds: List[openff.toolkit.topology.molecule.Bond]</dt><dd><p>The list of openff.toolkit.topology.molecule.Bond instances which are rotatable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-bson">
<h3><code class="docutils literal notranslate"><span class="pre">from_bson</span></code><a class="headerlink" href="#from-bson" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_bson">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_bson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_bson" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an object from a BSON serialized representation.</p>
<p>Specification: <a class="reference external" href="http://bsonspec.org/">http://bsonspec.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A BSON serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-dict">
<h3><code class="docutils literal notranslate"><span class="pre">from_dict</span></code><a class="headerlink" href="#from-dict" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_dict">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new Molecule from a dictionary representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecule_dict</strong><span class="classifier">OrderedDict</span></dt><dd><p>A dictionary representation of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">Molecule</span></dt><dd><p>A Molecule created from the dictionary representation</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-file">
<h3><code class="docutils literal notranslate"><span class="pre">from_file</span></code><a class="headerlink" href="#from-file" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_file">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">file_path</span></em>, <em class="sig-param"><span class="pre">file_format=None</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">allow_undefined_stereo=False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create one or more molecules from a file</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Extend this to also include some form of .offmol Open Force Field Molecule format?</p></li>
<li><p>Generalize this to also include file-like objects?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path</strong><span class="classifier">str or file-like object</span></dt><dd><p>The path to the file or file-like object to stream one or more molecules from.</p>
</dd>
<dt><strong>file_format</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Format specifier, usually file suffix (eg. ‘MOL2’, ‘SMI’)
Note that not all toolkits support all formats. Check ToolkitWrapper.toolkit_file_read_formats for your
loaded toolkits for details.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper,</span></dt><dd></dd>
<dt><strong>optional, default=GLOBAL_TOOLKIT_REGISTRY</strong></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for file loading. If a Toolkit is passed, only
the highest-precedence toolkit is used</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecules</strong><span class="classifier">Molecule or list of Molecules</span></dt><dd><p>If there is a single molecule in the file, a Molecule is returned;
otherwise, a list of Molecule objects is returned.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.tests.utils</span> <span class="kn">import</span> <span class="n">get_monomer_mol2_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol2_file_path</span> <span class="o">=</span> <span class="n">get_monomer_mol2_file_path</span><span class="p">(</span><span class="s1">&#39;cyclohexane&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mol2_file_path</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-inchi">
<h3><code class="docutils literal notranslate"><span class="pre">from_inchi</span></code><a class="headerlink" href="#from-inchi" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_inchi">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_inchi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">inchi</span></em>, <em class="sig-param"><span class="pre">allow_undefined_stereo=False</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Molecule from a InChI representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inchi</strong><span class="classifier">str</span></dt><dd><p>The InChI representation of the molecule.</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to accept InChI with undefined stereochemistry. If False,
an exception will be raised if a InChI with undefined stereochemistry
is passed into this function.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for InChI-to-molecule conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>make cis-1,2-Dichloroethene
&gt;&gt;&gt; molecule = Molecule.from_inchi(‘InChI=1S/C2H2Cl2/c3-1-2-4/h1-2H/b2-1-‘)</p>
</dd></dl>

</section>
<section class="hide-header" id="from-iupac">
<h3><code class="docutils literal notranslate"><span class="pre">from_iupac</span></code><a class="headerlink" href="#from-iupac" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_iupac">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_iupac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">iupac_name</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">allow_undefined_stereo=False</span></em>, <em class="sig-param"><span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_iupac" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a molecule from IUPAC or common name</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iupac_name</strong><span class="classifier">str</span></dt><dd><p>IUPAC name of molecule to be generated</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=GLOBAL_TOOLKIT_REGISTRY</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for chemical environment matches</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if molecule contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">Molecule</span></dt><dd><p>The resulting molecule with position</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method requires the OpenEye toolkit to be installed.
..</p>
</div>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a molecule from an IUPAC name</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;4-[(4-methylpiperazin-1-yl)methyl]-N-(4-methyl-3-{[4-(pyridin-3-yl)pyrimidin-2-yl]amino}phenyl)benzamide&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from a common name</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;imatinib&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-json">
<h3><code class="docutils literal notranslate"><span class="pre">from_json</span></code><a class="headerlink" href="#from-json" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_json">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an object from a JSON serialized representation.</p>
<p>Specification: <a class="reference external" href="https://www.json.org/">https://www.json.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A JSON serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-mapped-smiles">
<h3><code class="docutils literal notranslate"><span class="pre">from_mapped_smiles</span></code><a class="headerlink" href="#from-mapped-smiles" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_mapped_smiles">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_mapped_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">mapped_smiles</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">allow_undefined_stereo=False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an openff.toolkit.topology.molecule.Molecule from a mapped SMILES made with cmiles.
The molecule will be in the order of the indexing in the mapped smiles string.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mapped_smiles: str,</strong></dt><dd><p>A CMILES-style mapped smiles string with explicit hydrogens.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>offmol</strong><span class="classifier">openff.toolkit.topology.molecule.Molecule</span></dt><dd><p>An OpenFF molecule instance.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>SmilesParsingError</strong><span class="classifier">if the given SMILES had no indexing picked up by the toolkits.</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-messagepack">
<h3><code class="docutils literal notranslate"><span class="pre">from_messagepack</span></code><a class="headerlink" href="#from-messagepack" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_messagepack">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_messagepack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_messagepack" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an object from a MessagePack serialized representation.</p>
<p>Specification: <a class="reference external" href="https://msgpack.org/index.html">https://msgpack.org/index.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A MessagePack-encoded bytes serialized representation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>Instantiated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-openeye">
<h3><code class="docutils literal notranslate"><span class="pre">from_openeye</span></code><a class="headerlink" href="#from-openeye" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_openeye">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_openeye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oemol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_openeye" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Molecule from an OpenEye molecule.</p>
<p>Requires the OpenEye toolkit to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>oemol</strong><span class="classifier">openeye.oechem.OEMol</span></dt><dd><p>An OpenEye molecule</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An OpenFF molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a Molecule from an OpenEye OEMol</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openeye</span> <span class="kn">import</span> <span class="n">oechem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.tests.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ifs</span> <span class="o">=</span> <span class="n">oechem</span><span class="o">.</span><span class="n">oemolistream</span><span class="p">(</span><span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;systems/monomers/ethanol.mol2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oemols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ifs</span><span class="o">.</span><span class="n">GetOEGraphMols</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_openeye</span><span class="p">(</span><span class="n">oemols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-pdb-and-smiles">
<h3><code class="docutils literal notranslate"><span class="pre">from_pdb_and_smiles</span></code><a class="headerlink" href="#from-pdb-and-smiles" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_pdb_and_smiles">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_pdb_and_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_pdb_and_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Molecule from a pdb file and a SMILES string using RDKit.</p>
<p>Requires RDKit to be installed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<p>The molecule is created and sanitised based on the SMILES string, we then find a mapping
between this molecule and one from the PDB based only on atomic number and connections.
The SMILES molecule is then reindex to match the PDB, the conformer is attached and the
molecule returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path: str</strong></dt><dd><p>PDB file path</p>
</dd>
<dt><strong>smiles</strong><span class="classifier">str</span></dt><dd><p>a valid smiles string for the pdb, used for seterochemistry and bond order</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.Molecule</span></dt><dd><p>An OFFMol instance with ordering the same as used in the PDB file.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>InvalidConformerError</strong><span class="classifier">if the SMILES and PDB molecules are not isomorphic.</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-pickle">
<h3><code class="docutils literal notranslate"><span class="pre">from_pickle</span></code><a class="headerlink" href="#from-pickle" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_pickle">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an object from a pickle serialized representation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not recommended for safe, stable storage since the pickle specification
may change between Python versions.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A pickled representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-qcschema">
<h3><code class="docutils literal notranslate"><span class="pre">from_qcschema</span></code><a class="headerlink" href="#from-qcschema" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_qcschema">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_qcschema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qca_record</span></em>, <em class="sig-param"><span class="pre">client=None</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">allow_undefined_stereo=False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_qcschema" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Molecule from a QCArchive molecule record or dataset entry
based on attached cmiles information.</p>
<p>For a molecule record, a conformer will be set from its geometry.</p>
<p>For a dataset entry, if a corresponding client instance is provided,
the starting geometry for that entry will be used as a conformer.</p>
<p>A QCElemental Molecule produced from <cite>Molecule.to_qcschema</cite> can be round-tripped
through this method to produce a new, valid Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>qca_record</strong><span class="classifier">dict</span></dt><dd><p>A QCArchive molecule record or dataset entry.</p>
</dd>
<dt><strong>client</strong><span class="classifier">optional, default=None,</span></dt><dd><p>A qcportal.FractalClient instance to use for fetching an initial geometry.
Only used if <cite>qca_record</cite> is a dataset entry.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An OpenFF molecule instance.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>AttributeError</strong><span class="classifier">if the record dict can not be made from a record instance.</span></dt><dd><p>if a client is passed, because the client could not retrive the initial molecule.</p>
</dd>
<dt><strong>KeyError</strong><span class="classifier">if the dict does not contain the canonical_isomeric_explicit_hydrogen_mapped_smiles.</span></dt><dd></dd>
<dt><strong>InvalidConformerError</strong><span class="classifier">silent error, if the conformer could not be attached.</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Get Molecule from a QCArchive molecule record:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qcportal</span> <span class="kn">import</span> <span class="n">FractalClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">FractalClient</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">query_molecules</span><span class="p">(</span><span class="n">molecular_formula</span><span class="o">=</span><span class="s2">&quot;C16H20N3O5&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Get Molecule from a QCArchive optimization entry:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qcportal</span> <span class="kn">import</span> <span class="n">FractalClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">FractalClient</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optds</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="s2">&quot;OptimizationDataset&quot;</span><span class="p">,</span>
<span class="go">                                  &quot;SMIRNOFF Coverage Set 1&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span><span class="n">optds</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="s1">&#39;coc(o)oc-0&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Same as above, but with conformer(s) from initial molecule(s) by providing client to database:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">offmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span><span class="n">optds</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="s1">&#39;coc(o)oc-0&#39;</span><span class="p">),</span> <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-rdkit">
<h3><code class="docutils literal notranslate"><span class="pre">from_rdkit</span></code><a class="headerlink" href="#from-rdkit" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_rdkit">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_rdkit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdmol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogens_are_explicit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_rdkit" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Molecule from an RDKit molecule.</p>
<p>Requires the RDKit to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rdmol</strong><span class="classifier">rkit.RDMol</span></dt><dd><p>An RDKit molecule</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
<dt><strong>hydrogens_are_explicit</strong><span class="classifier">bool, default=False</span></dt><dd><p>If False, RDKit will perform hydrogen addition using Chem.AddHs</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An OpenFF molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a molecule from an RDKit molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.tests.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolFile</span><span class="p">(</span><span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;systems/monomers/ethanol.sdf&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_rdkit</span><span class="p">(</span><span class="n">rdmol</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-smiles">
<h3><code class="docutils literal notranslate"><span class="pre">from_smiles</span></code><a class="headerlink" href="#from-smiles" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_smiles">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">smiles</span></em>, <em class="sig-param"><span class="pre">hydrogens_are_explicit=False</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">allow_undefined_stereo=False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Molecule from a SMILES representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>smiles</strong><span class="classifier">str</span></dt><dd><p>The SMILES representation of the molecule.</p>
</dd>
<dt><strong>hydrogens_are_explicit</strong><span class="classifier">bool, default = False</span></dt><dd><p>If False, the cheminformatics toolkit will perform hydrogen addition</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to accept SMILES with undefined stereochemistry. If False,
an exception will be raised if a SMILES with undefined stereochemistry
is passed into this function.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;Cc1ccccc1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-toml">
<h3><code class="docutils literal notranslate"><span class="pre">from_toml</span></code><a class="headerlink" href="#from-toml" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_toml">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_toml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_toml" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an object from a TOML serialized representation.</p>
<p>Specification: <a class="reference external" href="https://github.com/toml-lang/toml">https://github.com/toml-lang/toml</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serlialized</strong><span class="classifier">str</span></dt><dd><p>A TOML serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-topology">
<h3><code class="docutils literal notranslate"><span class="pre">from_topology</span></code><a class="headerlink" href="#from-topology" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_topology">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Molecule representation of an OpenFF Topology containing a single Molecule object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>topology</strong><span class="classifier">openff.toolkit.topology.Topology</span></dt><dd><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code> object containing a single <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object.
Note that OpenMM and MDTraj <code class="docutils literal notranslate"><span class="pre">Topology</span></code> objects are not supported.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>The Molecule object in the topology</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the topology does not contain exactly one molecule.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a molecule from a Topology object that contains exactly one molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_topology</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="from-xml">
<h3><code class="docutils literal notranslate"><span class="pre">from_xml</span></code><a class="headerlink" href="#from-xml" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_xml">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an object from an XML serialized representation.</p>
<p>Specification: <a class="reference external" href="https://www.w3.org/XML/">https://www.w3.org/XML/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>An XML serialized representation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>Instantiated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="from-yaml">
<h3><code class="docutils literal notranslate"><span class="pre">from_yaml</span></code><a class="headerlink" href="#from-yaml" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_yaml">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate from a YAML serialized representation.</p>
<p>Specification: <a class="reference external" href="http://yaml.org/">http://yaml.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A YAML serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>Instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="generate-conformers">
<h3><code class="docutils literal notranslate"><span class="pre">generate_conformers</span></code><a class="headerlink" href="#generate-conformers" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.generate_conformers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">generate_conformers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em>, <em class="sig-param"><span class="pre">n_conformers=10</span></em>, <em class="sig-param"><span class="pre">rms_cutoff=None</span></em>, <em class="sig-param"><span class="pre">clear_existing=True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.generate_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate conformers for this molecule using an underlying toolkit. If n_conformers=0, no toolkit wrapper
will be called. If n_conformers=0 and clear_existing=True, molecule.conformers will be set to None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>n_conformers</strong><span class="classifier">int, default=1</span></dt><dd><p>The maximum number of conformers to produce</p>
</dd>
<dt><strong>rms_cutoff</strong><span class="classifier">simtk.Quantity-wrapped float, in units of distance, optional, default=None</span></dt><dd><p>The minimum RMS value at which two conformers are considered redundant and one is deleted. Precise
implementation of this cutoff may be toolkit-dependent. If None, the cutoff is set to be the default value
for each ToolkitWrapper (generally 1 Angstrom).</p>
</dd>
<dt><strong>clear_existing</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to overwrite existing conformers for the molecule</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;CCCCCC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">generate_conformers</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="generate-unique-atom-names">
<h3><code class="docutils literal notranslate"><span class="pre">generate_unique_atom_names</span></code><a class="headerlink" href="#generate-unique-atom-names" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.generate_unique_atom_names">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">generate_unique_atom_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.generate_unique_atom_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate unique atom names using element name and number of times that element has occurred
e.g. ‘C1’, ‘H1’, ‘O1’, ‘C2’, …</p>
</dd></dl>

</section>
<section class="hide-header" id="get-bond-between">
<h3><code class="docutils literal notranslate"><span class="pre">get_bond_between</span></code><a class="headerlink" href="#get-bond-between" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.get_bond_between">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">get_bond_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.get_bond_between" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bond between two atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>i, j</strong><span class="classifier">int or Atom</span></dt><dd><p>Atoms or atom indices to check</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>bond</strong><span class="classifier">Bond</span></dt><dd><p>The bond between i and j.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="is-isomorphic-with">
<h3><code class="docutils literal notranslate"><span class="pre">is_isomorphic_with</span></code><a class="headerlink" href="#is-isomorphic-with" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.is_isomorphic_with">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">is_isomorphic_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.is_isomorphic_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the molecule is isomorphic with the other molecule which can be an openff.toolkit.topology.Molecule,
or TopologyMolecule or nx.Graph(). Full matching is done using the options described bellow.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other: openff.toolkit.topology.Molecule or TopologyMolecule or nx.Graph()</strong></dt><dd></dd>
<dt><strong>return_atom_map: bool, default=False, optional</strong></dt><dd><p>will return an optional dict containing the atomic mapping.</p>
</dd>
<dt><strong>aromatic_matching: bool, default=True, optional</strong></dt><dd></dd>
<dt><strong>compare the aromatic attributes of bonds and atoms.</strong></dt><dd></dd>
<dt><strong>formal_charge_matching: bool, default=True, optional</strong></dt><dd></dd>
<dt><strong>compare the formal charges attributes of the atoms.</strong></dt><dd></dd>
<dt><strong>bond_order_matching: bool, deafult=True, optional</strong></dt><dd></dd>
<dt><strong>compare the bond order on attributes of the bonds.</strong></dt><dd></dd>
<dt><strong>atom_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, atoms’ stereochemistry is ignored for the
purpose of determining equality.</p>
</dd>
<dt><strong>bond_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, bonds’ stereochemistry is ignored for the
purpose of determining equality.</p>
</dd>
<dt><strong>strip_pyrimidal_n_atom_stereo: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, any stereochemistry defined around pyrimidal
nitrogen stereocenters will be disregarded in the isomorphism
check.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for
removing stereochemistry from pyrimidal nitrogens.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>isomorphic</strong><span class="classifier">bool</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="remap">
<h3><code class="docutils literal notranslate"><span class="pre">remap</span></code><a class="headerlink" href="#remap" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.remap">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">remap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_to_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.remap" title="Permalink to this definition">¶</a></dt>
<dd><p>Remap all of the indexes in the molecule to match the given mapping dict</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mapping_dict</strong><span class="classifier">dict,</span></dt><dd><p>A dictionary of the mapping between in the indexes, this should start from 0.</p>
</dd>
<dt><strong>current_to_new</strong><span class="classifier">bool, default=True</span></dt><dd><p>The dict is {current_index: new_index} if True else {new_index: current_index}</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>new_molecule</strong><span class="classifier">openff.toolkit.topology.molecule.Molecule</span></dt><dd><p>An openff.toolkit.Molecule instance with all attributes transferred, in the PDB order.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="strip-atom-stereochemistry">
<h3><code class="docutils literal notranslate"><span class="pre">strip_atom_stereochemistry</span></code><a class="headerlink" href="#strip-atom-stereochemistry" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.strip_atom_stereochemistry">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">strip_atom_stereochemistry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">smarts</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.strip_atom_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete stereochemistry information for certain atoms, if it is present.
This method can be used to “normalize” molecules imported from different cheminformatics
toolkits, which differ in which atom centers are considered stereogenic.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>smarts: str or ChemicalEnvironment</strong></dt><dd><p>Tagged SMARTS with a single atom with index 1. Any matches for this atom will have any assigned
stereocheistry information removed.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">a <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> object, optional, default=GLOBAL_TOOLKIT_REGISTRY</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for I/O operations</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-bson">
<h3><code class="docutils literal notranslate"><span class="pre">to_bson</span></code><a class="headerlink" href="#to-bson" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_bson">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_bson</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_bson" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a BSON serialized representation.</p>
<p>Specification: <a class="reference external" href="http://bsonspec.org/">http://bsonspec.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A BSON serialized representation of the objecft</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-dict">
<h3><code class="docutils literal notranslate"><span class="pre">to_dict</span></code><a class="headerlink" href="#to-dict" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_dict">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the molecule.</p>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Document the representation standard.</p></li>
<li><p>How do we do version control with this standard?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecule_dict</strong><span class="classifier">OrderedDict</span></dt><dd><p>A dictionary representation of the molecule.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-file">
<h3><code class="docutils literal notranslate"><span class="pre">to_file</span></code><a class="headerlink" href="#to-file" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_file">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">file_path</span></em>, <em class="sig-param"><span class="pre">file_format</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the current molecule to a file or file-like object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path</strong><span class="classifier">str or file-like object</span></dt><dd><p>A file-like object or the path to the file to be written.</p>
</dd>
<dt><strong>file_format</strong><span class="classifier">str</span></dt><dd><p>Format specifier, one of [‘MOL2’, ‘MOL2H’, ‘SDF’, ‘PDB’, ‘SMI’, ‘CAN’, ‘TDT’]
Note that not all toolkits support all formats</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper,</span></dt><dd></dd>
<dt><strong>optional, default=GLOBAL_TOOLKIT_REGISTRY</strong></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for file writing. If a Toolkit is passed, only
the highest-precedence toolkit is used</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>If the requested file_format is not supported by one of the installed cheminformatics toolkits</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;imatinib&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;imatinib.mol2&#39;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;mol2&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;imatinib.sdf&#39;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;sdf&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;imatinib.pdb&#39;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;pdb&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-hill-formula">
<h3><code class="docutils literal notranslate"><span class="pre">to_hill_formula</span></code><a class="headerlink" href="#to-hill-formula" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_hill_formula">
<em class="property"><span class="pre">static</span> </em><span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_hill_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_hill_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the Hill formula from either a FrozenMolecule, TopologyMolecule or
nx.Graph() of the molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">FrozenMolecule, TopologyMolecule or nx.Graph()</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>formula</strong><span class="classifier">the Hill formula of the molecule</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>NotImplementedError</strong><span class="classifier">if the molecule is not of one of the specified types.</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-inchi">
<h3><code class="docutils literal notranslate"><span class="pre">to_inchi</span></code><a class="headerlink" href="#to-inchi" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_inchi">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_inchi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fixed_hydrogens=False</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an InChI string for the molecule using the requested toolkit backend.
InChI is a standardised representation that does not capture tautomers unless specified using the fixed hydrogen
layer.</p>
<p>For information on InChi see here <a class="reference external" href="https://iupac.org/who-we-are/divisions/division-details/inchi/">https://iupac.org/who-we-are/divisions/division-details/inchi/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fixed_hydrogens: bool, default=False</strong></dt><dd><p>If a fixed hydrogen layer should be added to the InChI, if <cite>True</cite> this will produce a non standard specific
InChI string of the molecule.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for molecule-to-InChI conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>inchi: str</dt><dd><p>The InChI string of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-inchikey">
<h3><code class="docutils literal notranslate"><span class="pre">to_inchikey</span></code><a class="headerlink" href="#to-inchikey" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_inchikey">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_inchikey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fixed_hydrogens=False</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_inchikey" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an InChIKey for the molecule using the requested toolkit backend.
InChIKey is a standardised representation that does not capture tautomers unless specified using the fixed hydrogen
layer.</p>
<p>For information on InChi see here <a class="reference external" href="https://iupac.org/who-we-are/divisions/division-details/inchi/">https://iupac.org/who-we-are/divisions/division-details/inchi/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fixed_hydrogens: bool, default=False</strong></dt><dd><p>If a fixed hydrogen layer should be added to the InChI, if <cite>True</cite> this will produce a non standard specific
InChI string of the molecule.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for molecule-to-InChIKey conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>inchi_key: str</dt><dd><p>The InChIKey representation of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-iupac">
<h3><code class="docutils literal notranslate"><span class="pre">to_iupac</span></code><a class="headerlink" href="#to-iupac" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_iupac">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_iupac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_iupac" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate IUPAC name from Molecule</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iupac_name</strong><span class="classifier">str</span></dt><dd><p>IUPAC name of the molecule</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method requires the OpenEye toolkit to be installed.
..</p>
</div>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;molecules/ethanol.sdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iupac_name</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_iupac</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-json">
<h3><code class="docutils literal notranslate"><span class="pre">to_json</span></code><a class="headerlink" href="#to-json" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_json">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a JSON serialized representation.</p>
<p>Specification: <a class="reference external" href="https://www.json.org/">https://www.json.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indent</strong><span class="classifier">int, optional, default=None</span></dt><dd><p>If not None, will pretty-print with specified number of spaces for indentation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A JSON serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-messagepack">
<h3><code class="docutils literal notranslate"><span class="pre">to_messagepack</span></code><a class="headerlink" href="#to-messagepack" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_messagepack">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_messagepack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_messagepack" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a MessagePack representation.</p>
<p>Specification: <a class="reference external" href="https://msgpack.org/index.html">https://msgpack.org/index.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A MessagePack-encoded bytes serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-networkx">
<h3><code class="docutils literal notranslate"><span class="pre">to_networkx</span></code><a class="headerlink" href="#to-networkx" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_networkx">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_networkx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_networkx" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a NetworkX undirected graph from the Molecule.</p>
<p>Nodes are Atoms labeled with particle indices and atomic elements (via the <code class="docutils literal notranslate"><span class="pre">element</span></code> node atrribute).
Edges denote chemical bonds between Atoms.
Virtual sites are not included, since they lack a concept of chemical connectivity.</p>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we need a <code class="docutils literal notranslate"><span class="pre">from_networkx()</span></code> method? If so, what would the Graph be required to provide?</p></li>
<li><p>Should edges be labeled with discrete bond types in some aromaticity model?</p></li>
<li><p>Should edges be labeled with fractional bond order if a method is specified?</p></li>
<li><p>Should we add other per-atom and per-bond properties (e.g. partial charges) if present?</p></li>
<li><p>Can this encode bond/atom chirality?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>graph</strong><span class="classifier">networkx.Graph</span></dt><dd><p>The resulting graph, with nodes (atoms) labeled with atom indices, elements, stereochemistry and aromaticity
flags and bonds with two atom indices, bond order, stereochemistry, and aromaticity flags</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Retrieve the bond graph for imatinib (OpenEye toolkit required)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;imatinib&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nxgraph</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-openeye">
<h3><code class="docutils literal notranslate"><span class="pre">to_openeye</span></code><a class="headerlink" href="#to-openeye" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_openeye">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_openeye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aromaticity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'OEAroModel_MDL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_openeye" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an OpenEye molecule</p>
<p>Requires the OpenEye toolkit to be installed.</p>
<div class="admonition-todo admonition" id="id8">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Use stored conformer positions instead of an argument.</p></li>
<li><p>Should the aromaticity model be specified in some other way?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>aromaticity_model</strong><span class="classifier">str, optional, default=DEFAULT_AROMATICITY_MODEL</span></dt><dd><p>The aromaticity model to use</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>oemol</strong><span class="classifier">openeye.oechem.OEMol</span></dt><dd><p>An OpenEye molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create an OpenEye molecule from a Molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_openeye</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-pickle">
<h3><code class="docutils literal notranslate"><span class="pre">to_pickle</span></code><a class="headerlink" href="#to-pickle" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_pickle">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pickle serialized representation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not recommended for safe, stable storage since the pickle specification
may change between Python versions.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A pickled representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-qcschema">
<h3><code class="docutils literal notranslate"><span class="pre">to_qcschema</span></code><a class="headerlink" href="#to-qcschema" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_qcschema">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_qcschema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiplicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_qcschema" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QCElemental Molecule.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>multiplicity</strong><span class="classifier">int, default=1,</span></dt><dd><p>The multiplicity of the molecule;
sets <cite>molecular_multiplicity</cite> field for QCElemental Molecule.</p>
</dd>
<dt><strong>conformer</strong><span class="classifier">int, default=0,</span></dt><dd><p>The index of the conformer to use for the QCElemental Molecule geometry.</p>
</dd>
<dt><strong>extras</strong><span class="classifier">dict, default=None</span></dt><dd><p>A dictionary that should be included in the <cite>extras</cite> field on the QCElemental Molecule.
This can be used to include extra information, such as a smiles representation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>qcelemental.models.Molecule</dt><dd><p>A validated QCElemental Molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>MissingDependencyError</strong><span class="classifier">qcelemental is not installed, the qcschema can not be validated.</span></dt><dd></dd>
<dt><strong>InvalidConformerError</strong><span class="classifier">no conformer found at the given index.</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a QCElemental Molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">qcelemental</span> <span class="k">as</span> <span class="nn">qcel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">generate_conformers</span><span class="p">(</span><span class="n">n_conformers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qcemol</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">to_qcschema</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-rdkit">
<h3><code class="docutils literal notranslate"><span class="pre">to_rdkit</span></code><a class="headerlink" href="#to-rdkit" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_rdkit">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_rdkit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aromaticity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'OEAroModel_MDL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_rdkit" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an RDKit molecule</p>
<p>Requires the RDKit to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>aromaticity_model</strong><span class="classifier">str, optional, default=DEFAULT_AROMATICITY_MODEL</span></dt><dd><p>The aromaticity model to use</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rdmol</strong><span class="classifier">rkit.RDMol</span></dt><dd><p>An RDKit molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Convert a molecule to RDKit</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;molecules/ethanol.sdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-smiles">
<h3><code class="docutils literal notranslate"><span class="pre">to_smiles</span></code><a class="headerlink" href="#to-smiles" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_smiles">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">isomeric=True</span></em>, <em class="sig-param"><span class="pre">explicit_hydrogens=True</span></em>, <em class="sig-param"><span class="pre">mapped=False</span></em>, <em class="sig-param"><span class="pre">toolkit_registry=ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></em>, <em class="sig-param"><span class="pre">AmberTools</span></em>, <em class="sig-param"><span class="pre">Built-in</span> <span class="pre">Toolkit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a canonical isomeric SMILES representation of the current molecule.
A partially mapped smiles can also be generated for atoms of interest by supplying an <cite>atom_map</cite> to the
properties dictionary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RDKit and OpenEye versions will not necessarily return the same representation.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>isomeric: bool optional, default= True</strong></dt><dd><p>return an isomeric smiles</p>
</dd>
<dt><strong>explicit_hydrogens: bool optional, default=True</strong></dt><dd><p>return a smiles string containing all hydrogens explicitly</p>
</dd>
<dt><strong>mapped: bool optional, default=False</strong></dt><dd><p>return a explicit hydrogen mapped smiles, the atoms to be mapped can be controlled by supplying an
atom map into the properties dictionary. If no mapping is passed all atoms will be mapped in order, else
an atom map dictionary from the current atom index to the map id should be supplied with no duplicates.
The map ids (values) should start from 0 or 1.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None</span></dt><dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>smiles</strong><span class="classifier">str</span></dt><dd><p>Canonical isomeric explicit-hydrogen SMILES</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">&#39;molecules/ethanol.sdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smiles</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-toml">
<h3><code class="docutils literal notranslate"><span class="pre">to_toml</span></code><a class="headerlink" href="#to-toml" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_toml">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_toml</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_toml" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a TOML serialized representation.</p>
<p>Specification: <a class="reference external" href="https://github.com/toml-lang/toml">https://github.com/toml-lang/toml</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A TOML serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-topology">
<h3><code class="docutils literal notranslate"><span class="pre">to_topology</span></code><a class="headerlink" href="#to-topology" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_topology">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_topology</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an OpenFF Topology representation containing one copy of this molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>topology</strong><span class="classifier">openff.toolkit.topology.Topology</span></dt><dd><p>A Topology representation of this molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">&#39;imatinib&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topology</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_topology</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="hide-header" id="to-xml">
<h3><code class="docutils literal notranslate"><span class="pre">to_xml</span></code><a class="headerlink" href="#to-xml" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_xml">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an XML representation.</p>
<p>Specification: <a class="reference external" href="https://www.w3.org/XML/">https://www.w3.org/XML/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indent</strong><span class="classifier">int, optional, default=2</span></dt><dd><p>If not None, will pretty-print with specified number of spaces for indentation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A MessagePack-encoded bytes serialized representation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="to-yaml">
<h3><code class="docutils literal notranslate"><span class="pre">to_yaml</span></code><a class="headerlink" href="#to-yaml" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_yaml">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">to_yaml</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a YAML serialized representation.</p>
<p>Specification: <a class="reference external" href="http://yaml.org/">http://yaml.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A YAML serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="visualize">
<h3><code class="docutils literal notranslate"><span class="pre">visualize</span></code><a class="headerlink" href="#visualize" title="Permalink to this headline">¶</a></h3>
<dl class="py method autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.visualize">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Render a visualization of the molecule in Jupyter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>backend</strong><span class="classifier">str, optional, default=’rdkit’</span></dt><dd><p>Which visualization engine to use. Choose from:
- rdkit
- openeye
- nglview (conformers needed)</p>
</dd>
<dt><strong>width</strong><span class="classifier">int, optional, default=500</span></dt><dd><p>Width of the generated representation (only applicable to
backend=openeye)</p>
</dd>
<dt><strong>height</strong><span class="classifier">int, optional, default=300</span></dt><dd><p>Width of the generated representation (only applicable to
backend=openeye)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>object</dt><dd><p>Depending on the backend chosen:
- rdkit, openeye -&gt; IPython.display.Image
- nglview -&gt; nglview.NGLWidget</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section class="imitate-nested-in-previous-deflist" id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.amber_impropers" title="openff.toolkit.topology.Molecule.amber_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></p></td>
<td><p>Iterate over improper torsions in the molecule, but only those with trivalent centers, reporting the central atom first in each improper.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.angles" title="openff.toolkit.topology.Molecule.angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angles</span></code></a></p></td>
<td><p>Get an iterator over all i-j-k angles.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.atoms" title="openff.toolkit.topology.Molecule.atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atoms</span></code></a></p></td>
<td><p>Iterate over all Atom objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.bonds" title="openff.toolkit.topology.Molecule.bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bonds</span></code></a></p></td>
<td><p>Iterate over all Bond objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.conformers" title="openff.toolkit.topology.Molecule.conformers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conformers</span></code></a></p></td>
<td><p>Returns the list of conformers for this molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.has_unique_atom_names" title="openff.toolkit.topology.Molecule.has_unique_atom_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_unique_atom_names</span></code></a></p></td>
<td><p>True if the molecule has unique atom names, False otherwise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.hill_formula" title="openff.toolkit.topology.Molecule.hill_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hill_formula</span></code></a></p></td>
<td><p>Get the Hill formula of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.impropers" title="openff.toolkit.topology.Molecule.impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impropers</span></code></a></p></td>
<td><p>Iterate over all improper torsions in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_angles" title="openff.toolkit.topology.Molecule.n_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_angles</span></code></a></p></td>
<td><p>number of angles in the Molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_atoms" title="openff.toolkit.topology.Molecule.n_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_atoms</span></code></a></p></td>
<td><p>The number of Atom objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_bonds" title="openff.toolkit.topology.Molecule.n_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_bonds</span></code></a></p></td>
<td><p>The number of Bond objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_conformers" title="openff.toolkit.topology.Molecule.n_conformers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_conformers</span></code></a></p></td>
<td><p>Returns the number of conformers for this molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_impropers" title="openff.toolkit.topology.Molecule.n_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_impropers</span></code></a></p></td>
<td><p>number of possible improper torsions in the Molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_particles" title="openff.toolkit.topology.Molecule.n_particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_particles</span></code></a></p></td>
<td><p>The number of Particle objects, which corresponds to how many positions must be used.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_propers" title="openff.toolkit.topology.Molecule.n_propers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_propers</span></code></a></p></td>
<td><p>number of proper torsions in the Molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_rings" title="openff.toolkit.topology.Molecule.n_rings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_rings</span></code></a></p></td>
<td><p>Return the number of rings found in the Molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_virtual_particles" title="openff.toolkit.topology.Molecule.n_virtual_particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_virtual_particles</span></code></a></p></td>
<td><p>The number of VirtualParticle objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_virtual_sites" title="openff.toolkit.topology.Molecule.n_virtual_sites"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_virtual_sites</span></code></a></p></td>
<td><p>The number of VirtualSite objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.name" title="openff.toolkit.topology.Molecule.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></a></p></td>
<td><p>The name (or title) of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.partial_charges" title="openff.toolkit.topology.Molecule.partial_charges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partial_charges</span></code></a></p></td>
<td><p>Returns the partial charges (if present) on the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.particles" title="openff.toolkit.topology.Molecule.particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">particles</span></code></a></p></td>
<td><p>Iterate over all Particle objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.propers" title="openff.toolkit.topology.Molecule.propers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propers</span></code></a></p></td>
<td><p>Iterate over all proper torsions in the molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.properties" title="openff.toolkit.topology.Molecule.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a></p></td>
<td><p>The properties dictionary of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.rings" title="openff.toolkit.topology.Molecule.rings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rings</span></code></a></p></td>
<td><p>Return the number of rings in this molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="openff.toolkit.topology.Molecule.smirnoff_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a></p></td>
<td><p>Iterate over improper torsions in the molecule, but only those with trivalent centers, reporting the central atom second in each improper.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.torsions" title="openff.toolkit.topology.Molecule.torsions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torsions</span></code></a></p></td>
<td><p>Get an iterator over all i-j-k-l torsions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.total_charge" title="openff.toolkit.topology.Molecule.total_charge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_charge</span></code></a></p></td>
<td><p>Return the total charge on the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.virtual_sites" title="openff.toolkit.topology.Molecule.virtual_sites"><code class="xref py py-obj docutils literal notranslate"><span class="pre">virtual_sites</span></code></a></p></td>
<td><p>Iterate over all VirtualSite objects.</p></td>
</tr>
</tbody>
</table>
<section class="hide-header" id="amber-impropers">
<h3><code class="docutils literal notranslate"><span class="pre">amber_impropers</span></code><a class="headerlink" href="#amber-impropers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.amber_impropers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">amber_impropers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.amber_impropers" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over improper torsions in the molecule, but only those with
trivalent centers, reporting the central atom first in each improper.</p>
<p>Note that it’s possible that a trivalent center will not have an improper assigned.
This will depend on the force field that is used.</p>
<p>Also note that this will return 6 possible atom orderings around each improper
center. In current AMBER parameterization, one of these six
orderings will be used for the actual assignment of the improper term
and measurement of the angle. This method does not encode the logic to
determine which of the six orderings AMBER would use.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>impropers</strong><span class="classifier">set of tuple</span></dt><dd><p>An iterator of tuples, each containing the indices of atoms making
up a possible improper torsion. The central atom is listed first in
each tuple.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.impropers" title="openff.toolkit.topology.Molecule.impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impropers</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="openff.toolkit.topology.Molecule.smirnoff_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

</section>
<section class="hide-header" id="angles">
<h3><code class="docutils literal notranslate"><span class="pre">angles</span></code><a class="headerlink" href="#angles" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.angles">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">angles</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an iterator over all i-j-k angles.</p>
</dd></dl>

</section>
<section class="hide-header" id="atoms">
<h3><code class="docutils literal notranslate"><span class="pre">atoms</span></code><a class="headerlink" href="#atoms" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.atoms">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all Atom objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="bonds">
<h3><code class="docutils literal notranslate"><span class="pre">bonds</span></code><a class="headerlink" href="#bonds" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.bonds">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">bonds</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all Bond objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="conformers">
<h3><code class="docutils literal notranslate"><span class="pre">conformers</span></code><a class="headerlink" href="#conformers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.conformers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">conformers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of conformers for this molecule. This returns a list of simtk.unit.Quantity-wrapped numpy
arrays, of shape (3 x n_atoms) and with dimensions of distance. The return value is the actual list of
conformers, and changes to the contents affect the original FrozenMolecule.</p>
</dd></dl>

</section>
<section class="hide-header" id="has-unique-atom-names">
<h3><code class="docutils literal notranslate"><span class="pre">has_unique_atom_names</span></code><a class="headerlink" href="#has-unique-atom-names" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.has_unique_atom_names">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">has_unique_atom_names</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.has_unique_atom_names" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the molecule has unique atom names, False otherwise.</p>
</dd></dl>

</section>
<section class="hide-header" id="hill-formula">
<h3><code class="docutils literal notranslate"><span class="pre">hill_formula</span></code><a class="headerlink" href="#hill-formula" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.hill_formula">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">hill_formula</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.hill_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Hill formula of the molecule</p>
</dd></dl>

</section>
<section class="hide-header" id="impropers">
<h3><code class="docutils literal notranslate"><span class="pre">impropers</span></code><a class="headerlink" href="#impropers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.impropers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">impropers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.impropers" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all improper torsions in the molecule.</p>
<div class="admonition-todo admonition" id="id9">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we need to return a <code class="docutils literal notranslate"><span class="pre">Torsion</span></code> object that collects information about fractional bond orders?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>impropers</strong><span class="classifier">set of tuple</span></dt><dd><p>An iterator of tuples, each containing the indices of atoms making
up a possible improper torsion.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="openff.toolkit.topology.Molecule.smirnoff_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.amber_impropers" title="openff.toolkit.topology.Molecule.amber_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

</section>
<section class="hide-header" id="n-angles">
<h3><code class="docutils literal notranslate"><span class="pre">n_angles</span></code><a class="headerlink" href="#n-angles" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_angles">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_angles</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>number of angles in the Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="n-atoms">
<h3><code class="docutils literal notranslate"><span class="pre">n_atoms</span></code><a class="headerlink" href="#n-atoms" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_atoms">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_atoms</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of Atom objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="n-bonds">
<h3><code class="docutils literal notranslate"><span class="pre">n_bonds</span></code><a class="headerlink" href="#n-bonds" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_bonds">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_bonds</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of Bond objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="n-conformers">
<h3><code class="docutils literal notranslate"><span class="pre">n_conformers</span></code><a class="headerlink" href="#n-conformers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_conformers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_conformers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of conformers for this molecule.</p>
</dd></dl>

</section>
<section class="hide-header" id="n-impropers">
<h3><code class="docutils literal notranslate"><span class="pre">n_impropers</span></code><a class="headerlink" href="#n-impropers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_impropers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_impropers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_impropers" title="Permalink to this definition">¶</a></dt>
<dd><p>number of possible improper torsions in the Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="n-particles">
<h3><code class="docutils literal notranslate"><span class="pre">n_particles</span></code><a class="headerlink" href="#n-particles" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_particles">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_particles</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of Particle objects, which corresponds to how many positions must be used.</p>
</dd></dl>

</section>
<section class="hide-header" id="n-propers">
<h3><code class="docutils literal notranslate"><span class="pre">n_propers</span></code><a class="headerlink" href="#n-propers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_propers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_propers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_propers" title="Permalink to this definition">¶</a></dt>
<dd><p>number of proper torsions in the Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="n-rings">
<h3><code class="docutils literal notranslate"><span class="pre">n_rings</span></code><a class="headerlink" href="#n-rings" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_rings">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_rings</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_rings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of rings found in the Molecule</p>
<p>Requires the RDKit to be installed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For systems containing some special cases of connected rings, this
function may not be well-behaved and may report a different number
rings than expected. Some problematic cases include networks of many
(5+) rings or bicyclic moieties (i.e. norbornane).</p>
</div>
</dd></dl>

</section>
<section class="hide-header" id="n-virtual-particles">
<h3><code class="docutils literal notranslate"><span class="pre">n_virtual_particles</span></code><a class="headerlink" href="#n-virtual-particles" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_virtual_particles">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_virtual_particles</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_virtual_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of VirtualParticle objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="n-virtual-sites">
<h3><code class="docutils literal notranslate"><span class="pre">n_virtual_sites</span></code><a class="headerlink" href="#n-virtual-sites" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_virtual_sites">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">n_virtual_sites</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_virtual_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of VirtualSite objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="name">
<h3><code class="docutils literal notranslate"><span class="pre">name</span></code><a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.name">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name (or title) of the molecule</p>
</dd></dl>

</section>
<section class="hide-header" id="partial-charges">
<h3><code class="docutils literal notranslate"><span class="pre">partial_charges</span></code><a class="headerlink" href="#partial-charges" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.partial_charges">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">partial_charges</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.partial_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the partial charges (if present) on the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>partial_charges</strong><span class="classifier">a simtk.unit.Quantity - wrapped numpy array [1 x n_atoms] or None</span></dt><dd><p>The partial charges on this Molecule’s atoms. Returns None if no charges have been specified.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="particles">
<h3><code class="docutils literal notranslate"><span class="pre">particles</span></code><a class="headerlink" href="#particles" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.particles">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">particles</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all Particle objects.</p>
</dd></dl>

</section>
<section class="hide-header" id="propers">
<h3><code class="docutils literal notranslate"><span class="pre">propers</span></code><a class="headerlink" href="#propers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.propers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">propers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.propers" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all proper torsions in the molecule</p>
<div class="admonition-todo admonition" id="id10">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we need to return a <code class="docutils literal notranslate"><span class="pre">Torsion</span></code> object that collects information about fractional bond orders?</p></li>
</ul>
</div>
</dd></dl>

</section>
<section class="hide-header" id="properties">
<h3><code class="docutils literal notranslate"><span class="pre">properties</span></code><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.properties">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">properties</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.properties" title="Permalink to this definition">¶</a></dt>
<dd><p>The properties dictionary of the molecule</p>
</dd></dl>

</section>
<section class="hide-header" id="rings">
<h3><code class="docutils literal notranslate"><span class="pre">rings</span></code><a class="headerlink" href="#rings" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.rings">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">rings</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.rings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of rings in this molecule.</p>
<p>Requires the RDKit to be installed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For systems containing some special cases of connected rings, this
function may not be well-behaved and may report a different number
rings than expected. Some problematic cases include networks of many
(5+) rings or bicyclic moieties (i.e. norbornane).</p>
</div>
</dd></dl>

</section>
<section class="hide-header" id="smirnoff-impropers">
<h3><code class="docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code><a class="headerlink" href="#smirnoff-impropers" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.smirnoff_impropers">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">smirnoff_impropers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over improper torsions in the molecule, but only those with
trivalent centers, reporting the central atom second in each improper.</p>
<p>Note that it’s possible that a trivalent center will not have an improper assigned.
This will depend on the force field that is used.</p>
<p>Also note that this will return 6 possible atom orderings around each improper
center. In current SMIRNOFF parameterization, three of these six
orderings will be used for the actual assignment of the improper term
and measurement of the angles. These three orderings capture the three unique
angles that could be calculated around the improper center, therefore the sum
of these three terms will always return a consistent energy.</p>
<p>The exact three orderings that will be applied during parameterization can not be
determined in this method, since it requires sorting the particle indices, and
those indices may change when this molecule is added to a Topology.</p>
<p>For more details on the use of three-fold (‘trefoil’) impropers, see
<a class="reference external" href="https://open-forcefield-toolkit.readthedocs.io/en/latest/smirnoff.html#impropertorsions">https://open-forcefield-toolkit.readthedocs.io/en/latest/smirnoff.html#impropertorsions</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>impropers</strong><span class="classifier">set of tuple</span></dt><dd><p>An iterator of tuples, each containing the indices of atoms making
up a possible improper torsion. The central atom is listed second
in each tuple.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.impropers" title="openff.toolkit.topology.Molecule.impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impropers</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.amber_impropers" title="openff.toolkit.topology.Molecule.amber_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

</section>
<section class="hide-header" id="torsions">
<h3><code class="docutils literal notranslate"><span class="pre">torsions</span></code><a class="headerlink" href="#torsions" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.torsions">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">torsions</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.torsions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an iterator over all i-j-k-l torsions.
Note that i-j-k-i torsions (cycles) are excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>torsions</strong><span class="classifier">iterable of 4-Atom tuples</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section class="hide-header" id="total-charge">
<h3><code class="docutils literal notranslate"><span class="pre">total_charge</span></code><a class="headerlink" href="#total-charge" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.total_charge">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">total_charge</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.total_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total charge on the molecule</p>
</dd></dl>

</section>
<section class="hide-header" id="virtual-sites">
<h3><code class="docutils literal notranslate"><span class="pre">virtual_sites</span></code><a class="headerlink" href="#virtual-sites" title="Permalink to this headline">¶</a></h3>
<dl class="py attribute autosummary-child-object">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.virtual_sites">
<span class="sig-prename descclassname"><span class="pre">Molecule.</span></span><span class="sig-name descname"><span class="pre">virtual_sites</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.virtual_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all VirtualSite objects.</p>
</dd></dl>

</section>
</section>
</section>


          </article>
        </div>

        <aside class="column is-hidden-mobile is-2-desktop is-3-tablet">
          
<nav class="ff-localtoc menu">
  <p class="menu-label">Contents</p>
  <ul>
<li><a class="reference internal" href="#">openff.toolkit.topology.Molecule</a><ul>
<li><a class="reference internal" href="#init"><code class="docutils literal notranslate"><span class="pre">__init__</span></code></a></li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#add-atom"><code class="docutils literal notranslate"><span class="pre">add_atom</span></code></a></li>
<li><a class="reference internal" href="#add-bond"><code class="docutils literal notranslate"><span class="pre">add_bond</span></code></a></li>
<li><a class="reference internal" href="#add-bond-charge-virtual-site"><code class="docutils literal notranslate"><span class="pre">add_bond_charge_virtual_site</span></code></a></li>
<li><a class="reference internal" href="#add-conformer"><code class="docutils literal notranslate"><span class="pre">add_conformer</span></code></a></li>
<li><a class="reference internal" href="#add-divalent-lone-pair-virtual-site"><code class="docutils literal notranslate"><span class="pre">add_divalent_lone_pair_virtual_site</span></code></a></li>
<li><a class="reference internal" href="#add-monovalent-lone-pair-virtual-site"><code class="docutils literal notranslate"><span class="pre">add_monovalent_lone_pair_virtual_site</span></code></a></li>
<li><a class="reference internal" href="#add-trivalent-lone-pair-virtual-site"><code class="docutils literal notranslate"><span class="pre">add_trivalent_lone_pair_virtual_site</span></code></a></li>
<li><a class="reference internal" href="#apply-elf-conformer-selection"><code class="docutils literal notranslate"><span class="pre">apply_elf_conformer_selection</span></code></a></li>
<li><a class="reference internal" href="#are-isomorphic"><code class="docutils literal notranslate"><span class="pre">are_isomorphic</span></code></a></li>
<li><a class="reference internal" href="#assign-fractional-bond-orders"><code class="docutils literal notranslate"><span class="pre">assign_fractional_bond_orders</span></code></a></li>
<li><a class="reference internal" href="#assign-partial-charges"><code class="docutils literal notranslate"><span class="pre">assign_partial_charges</span></code></a></li>
<li><a class="reference internal" href="#canonical-order-atoms"><code class="docutils literal notranslate"><span class="pre">canonical_order_atoms</span></code></a></li>
<li><a class="reference internal" href="#chemical-environment-matches"><code class="docutils literal notranslate"><span class="pre">chemical_environment_matches</span></code></a></li>
<li><a class="reference internal" href="#compute-partial-charges-am1bcc"><code class="docutils literal notranslate"><span class="pre">compute_partial_charges_am1bcc</span></code></a></li>
<li><a class="reference internal" href="#enumerate-protomers"><code class="docutils literal notranslate"><span class="pre">enumerate_protomers</span></code></a></li>
<li><a class="reference internal" href="#enumerate-stereoisomers"><code class="docutils literal notranslate"><span class="pre">enumerate_stereoisomers</span></code></a></li>
<li><a class="reference internal" href="#enumerate-tautomers"><code class="docutils literal notranslate"><span class="pre">enumerate_tautomers</span></code></a></li>
<li><a class="reference internal" href="#find-rotatable-bonds"><code class="docutils literal notranslate"><span class="pre">find_rotatable_bonds</span></code></a></li>
<li><a class="reference internal" href="#from-bson"><code class="docutils literal notranslate"><span class="pre">from_bson</span></code></a></li>
<li><a class="reference internal" href="#from-dict"><code class="docutils literal notranslate"><span class="pre">from_dict</span></code></a></li>
<li><a class="reference internal" href="#from-file"><code class="docutils literal notranslate"><span class="pre">from_file</span></code></a></li>
<li><a class="reference internal" href="#from-inchi"><code class="docutils literal notranslate"><span class="pre">from_inchi</span></code></a></li>
<li><a class="reference internal" href="#from-iupac"><code class="docutils literal notranslate"><span class="pre">from_iupac</span></code></a></li>
<li><a class="reference internal" href="#from-json"><code class="docutils literal notranslate"><span class="pre">from_json</span></code></a></li>
<li><a class="reference internal" href="#from-mapped-smiles"><code class="docutils literal notranslate"><span class="pre">from_mapped_smiles</span></code></a></li>
<li><a class="reference internal" href="#from-messagepack"><code class="docutils literal notranslate"><span class="pre">from_messagepack</span></code></a></li>
<li><a class="reference internal" href="#from-openeye"><code class="docutils literal notranslate"><span class="pre">from_openeye</span></code></a></li>
<li><a class="reference internal" href="#from-pdb-and-smiles"><code class="docutils literal notranslate"><span class="pre">from_pdb_and_smiles</span></code></a></li>
<li><a class="reference internal" href="#from-pickle"><code class="docutils literal notranslate"><span class="pre">from_pickle</span></code></a></li>
<li><a class="reference internal" href="#from-qcschema"><code class="docutils literal notranslate"><span class="pre">from_qcschema</span></code></a></li>
<li><a class="reference internal" href="#from-rdkit"><code class="docutils literal notranslate"><span class="pre">from_rdkit</span></code></a></li>
<li><a class="reference internal" href="#from-smiles"><code class="docutils literal notranslate"><span class="pre">from_smiles</span></code></a></li>
<li><a class="reference internal" href="#from-toml"><code class="docutils literal notranslate"><span class="pre">from_toml</span></code></a></li>
<li><a class="reference internal" href="#from-topology"><code class="docutils literal notranslate"><span class="pre">from_topology</span></code></a></li>
<li><a class="reference internal" href="#from-xml"><code class="docutils literal notranslate"><span class="pre">from_xml</span></code></a></li>
<li><a class="reference internal" href="#from-yaml"><code class="docutils literal notranslate"><span class="pre">from_yaml</span></code></a></li>
<li><a class="reference internal" href="#generate-conformers"><code class="docutils literal notranslate"><span class="pre">generate_conformers</span></code></a></li>
<li><a class="reference internal" href="#generate-unique-atom-names"><code class="docutils literal notranslate"><span class="pre">generate_unique_atom_names</span></code></a></li>
<li><a class="reference internal" href="#get-bond-between"><code class="docutils literal notranslate"><span class="pre">get_bond_between</span></code></a></li>
<li><a class="reference internal" href="#is-isomorphic-with"><code class="docutils literal notranslate"><span class="pre">is_isomorphic_with</span></code></a></li>
<li><a class="reference internal" href="#remap"><code class="docutils literal notranslate"><span class="pre">remap</span></code></a></li>
<li><a class="reference internal" href="#strip-atom-stereochemistry"><code class="docutils literal notranslate"><span class="pre">strip_atom_stereochemistry</span></code></a></li>
<li><a class="reference internal" href="#to-bson"><code class="docutils literal notranslate"><span class="pre">to_bson</span></code></a></li>
<li><a class="reference internal" href="#to-dict"><code class="docutils literal notranslate"><span class="pre">to_dict</span></code></a></li>
<li><a class="reference internal" href="#to-file"><code class="docutils literal notranslate"><span class="pre">to_file</span></code></a></li>
<li><a class="reference internal" href="#to-hill-formula"><code class="docutils literal notranslate"><span class="pre">to_hill_formula</span></code></a></li>
<li><a class="reference internal" href="#to-inchi"><code class="docutils literal notranslate"><span class="pre">to_inchi</span></code></a></li>
<li><a class="reference internal" href="#to-inchikey"><code class="docutils literal notranslate"><span class="pre">to_inchikey</span></code></a></li>
<li><a class="reference internal" href="#to-iupac"><code class="docutils literal notranslate"><span class="pre">to_iupac</span></code></a></li>
<li><a class="reference internal" href="#to-json"><code class="docutils literal notranslate"><span class="pre">to_json</span></code></a></li>
<li><a class="reference internal" href="#to-messagepack"><code class="docutils literal notranslate"><span class="pre">to_messagepack</span></code></a></li>
<li><a class="reference internal" href="#to-networkx"><code class="docutils literal notranslate"><span class="pre">to_networkx</span></code></a></li>
<li><a class="reference internal" href="#to-openeye"><code class="docutils literal notranslate"><span class="pre">to_openeye</span></code></a></li>
<li><a class="reference internal" href="#to-pickle"><code class="docutils literal notranslate"><span class="pre">to_pickle</span></code></a></li>
<li><a class="reference internal" href="#to-qcschema"><code class="docutils literal notranslate"><span class="pre">to_qcschema</span></code></a></li>
<li><a class="reference internal" href="#to-rdkit"><code class="docutils literal notranslate"><span class="pre">to_rdkit</span></code></a></li>
<li><a class="reference internal" href="#to-smiles"><code class="docutils literal notranslate"><span class="pre">to_smiles</span></code></a></li>
<li><a class="reference internal" href="#to-toml"><code class="docutils literal notranslate"><span class="pre">to_toml</span></code></a></li>
<li><a class="reference internal" href="#to-topology"><code class="docutils literal notranslate"><span class="pre">to_topology</span></code></a></li>
<li><a class="reference internal" href="#to-xml"><code class="docutils literal notranslate"><span class="pre">to_xml</span></code></a></li>
<li><a class="reference internal" href="#to-yaml"><code class="docutils literal notranslate"><span class="pre">to_yaml</span></code></a></li>
<li><a class="reference internal" href="#visualize"><code class="docutils literal notranslate"><span class="pre">visualize</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#attributes">Attributes</a><ul>
<li><a class="reference internal" href="#amber-impropers"><code class="docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></li>
<li><a class="reference internal" href="#angles"><code class="docutils literal notranslate"><span class="pre">angles</span></code></a></li>
<li><a class="reference internal" href="#atoms"><code class="docutils literal notranslate"><span class="pre">atoms</span></code></a></li>
<li><a class="reference internal" href="#bonds"><code class="docutils literal notranslate"><span class="pre">bonds</span></code></a></li>
<li><a class="reference internal" href="#conformers"><code class="docutils literal notranslate"><span class="pre">conformers</span></code></a></li>
<li><a class="reference internal" href="#has-unique-atom-names"><code class="docutils literal notranslate"><span class="pre">has_unique_atom_names</span></code></a></li>
<li><a class="reference internal" href="#hill-formula"><code class="docutils literal notranslate"><span class="pre">hill_formula</span></code></a></li>
<li><a class="reference internal" href="#impropers"><code class="docutils literal notranslate"><span class="pre">impropers</span></code></a></li>
<li><a class="reference internal" href="#n-angles"><code class="docutils literal notranslate"><span class="pre">n_angles</span></code></a></li>
<li><a class="reference internal" href="#n-atoms"><code class="docutils literal notranslate"><span class="pre">n_atoms</span></code></a></li>
<li><a class="reference internal" href="#n-bonds"><code class="docutils literal notranslate"><span class="pre">n_bonds</span></code></a></li>
<li><a class="reference internal" href="#n-conformers"><code class="docutils literal notranslate"><span class="pre">n_conformers</span></code></a></li>
<li><a class="reference internal" href="#n-impropers"><code class="docutils literal notranslate"><span class="pre">n_impropers</span></code></a></li>
<li><a class="reference internal" href="#n-particles"><code class="docutils literal notranslate"><span class="pre">n_particles</span></code></a></li>
<li><a class="reference internal" href="#n-propers"><code class="docutils literal notranslate"><span class="pre">n_propers</span></code></a></li>
<li><a class="reference internal" href="#n-rings"><code class="docutils literal notranslate"><span class="pre">n_rings</span></code></a></li>
<li><a class="reference internal" href="#n-virtual-particles"><code class="docutils literal notranslate"><span class="pre">n_virtual_particles</span></code></a></li>
<li><a class="reference internal" href="#n-virtual-sites"><code class="docutils literal notranslate"><span class="pre">n_virtual_sites</span></code></a></li>
<li><a class="reference internal" href="#name"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#partial-charges"><code class="docutils literal notranslate"><span class="pre">partial_charges</span></code></a></li>
<li><a class="reference internal" href="#particles"><code class="docutils literal notranslate"><span class="pre">particles</span></code></a></li>
<li><a class="reference internal" href="#propers"><code class="docutils literal notranslate"><span class="pre">propers</span></code></a></li>
<li><a class="reference internal" href="#properties"><code class="docutils literal notranslate"><span class="pre">properties</span></code></a></li>
<li><a class="reference internal" href="#rings"><code class="docutils literal notranslate"><span class="pre">rings</span></code></a></li>
<li><a class="reference internal" href="#smirnoff-impropers"><code class="docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a></li>
<li><a class="reference internal" href="#torsions"><code class="docutils literal notranslate"><span class="pre">torsions</span></code></a></li>
<li><a class="reference internal" href="#total-charge"><code class="docutils literal notranslate"><span class="pre">total_charge</span></code></a></li>
<li><a class="reference internal" href="#virtual-sites"><code class="docutils literal notranslate"><span class="pre">virtual_sites</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

</nav>
        </aside>
      </div>
  </main>
  <footer class="footer">
  <div class="footer-content">
        <nav class="level">
          <div class="level-left">
            
              <div class="level-item">
                <a href="../numpydoc.html" title="Openff-toolkit example"
                   class="icon-text"
                   rel="prev">

                    <span class="icon">
                      <i class="fas fa-arrow-left"></i>
                    </span>
                    <span class="is-size-5">Openff-toolkit example</span>
                </a>
              </div>
            
          </div>
          <div class="level-right">
            
              <div class="level-item">
                <a href="../pydantic.html" title="Pydantic API docs"
                   class="icon-text"
                   rel="next">

                    <span class="is-size-5">Pydantic API docs</span>
                    <span class="icon">
                      <i class="fas fa-arrow-right"></i>
                    </span>
                </a>
              </div>
            
          </div>
        </nav>
      
    <div class="columns">
      <div class="fineprint column">
          <div class="copyright">
              &#169; Copyright 2021, Open Force Field Initiative.
              
          </div>
          Last updated on
            Jul 12, 2021.
          <br/>
          Created using
          <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.1.0.
           and
          <a href="https://github.com/openforcefield/openff-sphinx-theme/">the Open Force Field Sphinx theme</a>
      </div>
      <div class="socials column">
        <p class="pb-3">An <a href="https://openforcefield.org/" class="has-text-white">Open Force Field Initiative</a> project.</p>
        <div>
          
            
              
                <a href="https://zenodo.org/communities/openforcefield/" class="icon has-text-light is-medium" title="OpenFF on Zenodo">
                  <i class="fa-lg ai-lg ai ai-zenodo"></i>
                </a>
              
            
              
                <a href="https://www.youtube.com/channel/UCh0aJSUm_sYr7nuTzhW806g" class="icon has-text-light is-medium" title="OpenFF on YouTube">
                  <i class="fa-lg ai-lg fab fa-youtube"></i>
                </a>
              
            
              
                <a href="https://github.com/openforcefield" class="icon has-text-light is-medium" title="OpenFF on GitHub">
                  <i class="fa-lg ai-lg fab fa-github"></i>
                </a>
              
            
              
                <a href="https://twitter.com/openforcefield" class="icon has-text-light is-medium" title="OpenFF on Twitter">
                  <i class="fa-lg ai-lg fab fa-twitter"></i>
                </a>
              
            
              
                <a href="https://www.linkedin.com/company/openforcefield/" class="icon has-text-light is-medium" title="OpenFF on LinkedIn">
                  <i class="fa-lg ai-lg fab fa-linkedin"></i>
                </a>
              
            
          
        </div>

      </div>
    </div>
  </div>
</footer>
  </body>
</html>