<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<link href="../_static/images/favicon.svg" rel="icon" type="image/svg"/>
<link href="../_static/images/favicon.svg" rel="apple-touch-icon" type="image/svg"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" referrerpolicy="no-referrer" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" referrerpolicy="no-referrer" rel="stylesheet"/>
<link href="../_static/site.css" rel="stylesheet"/>
<meta content="#015480;" name="theme-color"/>
<title>openff.toolkit.topology.Molecule — OpenFF Sphinx theme</title>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../_static/openff.css" rel="stylesheet" type="text/css"/>
<link href="../_static/autodoc_pydantic.css" rel="stylesheet" type="text/css"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../pydantic.html" rel="next" title="Pydantic API docs"/>
<link href="../numpydoc.html" rel="prev" title="Openff-toolkit example"/>
</head>
<body class="has-navbar-fixed-top" data-md-color-accent="openff-toolkit-blue" dir="ltr">
<header data-md-component="header">
<nav aria-label="main navigation" class="navbar is-primary is-fixed-top is-flex-touch has-shadow" role="navigation">
<div class="navbar-brand">
<a class="navbar-item is-hidden-mobile" href="../index.html" title="OpenFF Sphinx theme">
<img alt="OpenFF Sphinx theme logo" src="../_static/images/logos/openforcefield_v1_white.png"/>
</a>
</div>
<div class="has-text-light is-hidden-mobile nav-title">
<div class="breadcrumb">
<ul>
<li><a href="../index.html">OpenFF Sphinx theme</a></li>
<li><a href="../numpydoc.html">Openff-toolkit example</a></li>
<li class="is-active"><a href="#">openff.toolkit.topology.Molecule</a></li>
</ul>
</div>
</div>
<div class="has-text-light is-hidden-tablet nav-title">
<span> openff.toolkit.topology.Molecule </span>
</div>
<div class="navbar-end">
<span class="navbar-item nav-search is-hidden-mobile">
<form action="../search.html" method="GET" name="search">
<div class="control has-icons-right">
<span class="icon is-small is-right">
<i class="fas fa-search"></i>
</span>
<input autocapitalize="off" autocomplete="off" class="input is-primary" name="q" placeholder="Search" spellcheck="false" type="text"/>
</div>
</form>
</span>
<a class="is-family-monospace navbar-item is-hidden-touch has-text-light" href="https://github.com/openforcefield/openff-sphinx-theme/">
<span class="icon-text">
<span class="icon">
<i class="fab fa-github"></i>
</span>
<span>
          
            openff-sphinx-theme
          
            </span>
</span>
</a>
<a class="navbar-item is-hidden-touch" href="https://docs.openforcefield.org/">
<img alt="Open Force Field Initiative logo" src="../_static/images/logos/openforcefield_v2_white.png"/>
</a>
</div>
<span class="navbar-burger-spacer is-hidden-tablet"></span>
</nav>
<div class="level is-hidden-mobile nav-tabs">
<div class="level-item has-text-centered"><a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div>
<div class="level-item has-text-centered"><a href="https://bashtage.github.io/sphinx-material/">Material for Sphinx</a></div>
<div class="level-item has-text-centered"><a href="https://openforcefield.org">The OpenFF Initiative</a></div>
<div class="level-item has-text-centered"><a href="https://github.com/openforcefield/openff-sphinx-theme/">openff-sphinx-theme on GitHub</a></div>
</div>
</header>
<main class="mb-6">
<div class="columns">
<input class="is-hidden" id="drawer-toggle" type="checkbox"/>
<label class="navbar-burger burger is-light is-hidden-tablet" for="drawer-toggle" role="button">
<span aria-hidden="true"></span>
<span aria-hidden="true"></span>
<span aria-hidden="true"></span>
<span aria-hidden="true"></span>
</label>
<aside class="column is-2-desktop is-3-tablet" id="drawer">
<div class="is-hidden-tablet clip-siblings">
<a href="../index.html" title="OpenFF Sphinx theme">
<h1>
                OpenFF Sphinx theme
              </h1>
</a>
<div class="py-3">
<form action="../search.html" method="GET" name="search">
<div class="control has-icons-right">
<span class="icon is-small is-right">
<i class="fas fa-search"></i>
</span>
<input autocapitalize="off" autocomplete="off" class="input is-primary" name="q" placeholder="Search" spellcheck="false" type="text"/>
</div>
</form>
</div>
</div>
<nav class="menu ff-globaltoc">
<p class="menu-label"><span class="caption-text">Basic Use</span></p>
<ul class="menu-list">
<li>
<a class="" href="../customization.html">Customization</a>
</li>
<li>
<a class="" href="../specimen.html">Specimen</a>
</li>
<li>
<a class="" href="../additional_samples.html"><code class="docutils literal notranslate"><span class="pre">additional_samples_with_very_long_name</span></code></a>
</li>
<li>
<a class="" href="../subpage/index.html"><code class="docutils literal notranslate"><span class="pre">Level</span> <span class="pre">1</span></code> page</a>
</li>
</ul>
<p class="menu-label"><span class="caption-text">Other Examples and Uses</span></p>
<ul class="menu-list">
<li>
<a class="" href="../pymethod.html">Python Methods</a>
</li>
<li>
<a class="" href="../numpydoc_example.html">NumPy Docstrings</a>
</li>
<li>
<a class="" href="../autodoc_pydantic_example.html">autodoc_pydantic API Docs</a>
</li>
<li>
<a class="" href="../numpydoc.html">Openff-toolkit example</a>
<ul class="menu-list">
<li>
<a class="is-active" href="#">openff.toolkit.topology.Molecule</a>
</li>
</ul>
</li>
<li>
<a class="" href="../pydantic.html">Pydantic API docs</a>
</li>
<li>
<a class="" href="../notebook.html">Jupyter Notebooks</a>
</li>
<li>
<a class="" href="../markdown.html">Markdown</a>
</li>
<li>
<a class="" href="../rst-cheatsheet/rst-cheatsheet.html">rst Cheatsheet</a>
</li>
<li>
<a class="" href="../primer.html">reStructuredText Primer</a>
</li>
<li>
<a class="" href="../expanded-tables.html">Expanded tables</a>
</li>
</ul>
<p class="menu-label"><span class="caption-text">Changes and License</span></p>
<ul class="menu-list">
<li>
<a class="" href="../change-log.html">Change Log</a>
</li>
<li>
<a class="" href="../license.html">License</a>
</li>
</ul>
</nav>
</aside>
<div class="column is-8-desktop is-9-tablet">
<article class="content">
<section id="openff-toolkit-topology-molecule">
<h1>openff.toolkit.topology.Molecule<a class="headerlink" href="#openff-toolkit-topology-molecule" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">openff.toolkit.topology.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Mutable chemical representation of a molecule, such as a small molecule or biopolymer.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>What other API calls would be useful for supporting biopolymers as small molecules? Perhaps iterating
over chains and residues?</p>
</div>
<p class="rubric">Examples</p>
<p>Create a molecule from an sdf file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">'molecules/ethanol.sdf'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to OpenEye OEMol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_openeye</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an OpenEye molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_openeye</span><span class="p">(</span><span class="n">oemol</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to RDKit Mol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an RDKit molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_rdkit</span><span class="p">(</span><span class="n">rdmol</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from IUPAC name (requires the OpenEye toolkit)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'imatinib'</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from SMILES</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'Cc1ccccc1'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.__init__" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a new Molecule object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other</strong><span class="classifier">optional, default=None</span></dt><dd><p>If specified, attempt to construct a copy of the molecule from the
specified object. This can be any one of the following:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p></li>
<li><p>a file that can be used to construct a <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p></li>
<li><p>an <code class="docutils literal notranslate"><span class="pre">openeye.oechem.OEMol</span></code></p></li>
<li><p>an <code class="docutils literal notranslate"><span class="pre">rdkit.Chem.rdchem.Mol</span></code></p></li>
<li><p>a serialized <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create an empty molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">empty_molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from a file that can be used to construct a molecule,
using either a filename or file-like object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">'molecules/ethanol.sdf'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">),</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">'sdf'</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol2_gz_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">'molecules/toluene.mol2.gz'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">gzip</span><span class="o">.</span><span class="n">GzipFile</span><span class="p">(</span><span class="n">mol2_gz_filepath</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">),</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">'mol2'</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a molecule from another molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule_copy</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to OpenEye OEMol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_openeye</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an OpenEye molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">oemol</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert to RDKit Mol object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a molecule from an RDKit molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">rdmol</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert the molecule into a dictionary and back again:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">serialized_molecule</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule_copy</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">serialized_molecule</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>If a filename or file-like object is specified but the file
contains more than one molecule, what is the proper behavior?
Read just the first molecule, or raise an exception if more
than one molecule is found?</p></li>
<li><p>Should we also support SMILES strings or IUPAC names for
<code class="docutils literal notranslate"><span class="pre">other</span></code>?</p></li>
</ul>
</div>
</dd></dl>
<p class="rubric">Methods</p>
<div class="table-container autosummary longtable docutils align-default"><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.__init__" title="openff.toolkit.topology.Molecule.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(*args, **kwargs)</p></td>
<td><p>Create a new Molecule object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_atom" title="openff.toolkit.topology.Molecule.add_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atom</span></code></a>(atomic_number, formal_charge, ...)</p></td>
<td><p>Add an atom to the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_bond" title="openff.toolkit.topology.Molecule.add_bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_bond</span></code></a>(atom1, atom2, bond_order, is_aromatic)</p></td>
<td><p>Add a bond between two specified atom indices</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_conformer" title="openff.toolkit.topology.Molecule.add_conformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_conformer</span></code></a>(coordinates)</p></td>
<td><p>Add a conformation of the molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_default_hierarchy_schemes" title="openff.toolkit.topology.Molecule.add_default_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_default_hierarchy_schemes</span></code></a>([...])</p></td>
<td><p>Adds <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">residue</span></code> hierarchy schemes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_hierarchy_scheme" title="openff.toolkit.topology.Molecule.add_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_hierarchy_scheme</span></code></a>(uniqueness_criteria, ...)</p></td>
<td><p>Use the molecule's metadata to facilitate iteration over its atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.apply_elf_conformer_selection" title="openff.toolkit.topology.Molecule.apply_elf_conformer_selection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_elf_conformer_selection</span></code></a>([percentage, ...])</p></td>
<td><p>Select a set of diverse conformers from the molecule's conformers with ELF.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.are_isomorphic" title="openff.toolkit.topology.Molecule.are_isomorphic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">are_isomorphic</span></code></a>(mol1, mol2[, ...])</p></td>
<td><p>Determine if <code class="docutils literal notranslate"><span class="pre">mol1</span></code> is isomorphic to <code class="docutils literal notranslate"><span class="pre">mol2</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.assign_fractional_bond_orders" title="openff.toolkit.topology.Molecule.assign_fractional_bond_orders"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_fractional_bond_orders</span></code></a>([...])</p></td>
<td><p>Update and store list of bond orders this molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.assign_partial_charges" title="openff.toolkit.topology.Molecule.assign_partial_charges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_partial_charges</span></code></a>(partial_charge_method)</p></td>
<td><p>Calculate partial atomic charges and store them in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.atom" title="openff.toolkit.topology.Molecule.atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom</span></code></a>(index)</p></td>
<td><p>Get the atom with the specified index.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.atom_index" title="openff.toolkit.topology.Molecule.atom_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_index</span></code></a>(atom)</p></td>
<td><p>Returns the index of the given atom in this molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.bond" title="openff.toolkit.topology.Molecule.bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond</span></code></a>(index)</p></td>
<td><p>Get the bond with the specified index.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.canonical_order_atoms" title="openff.toolkit.topology.Molecule.canonical_order_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">canonical_order_atoms</span></code></a>([toolkit_registry])</p></td>
<td><p>Produce a copy of the molecule with the atoms reordered canonically.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.chemical_environment_matches" title="openff.toolkit.topology.Molecule.chemical_environment_matches"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chemical_environment_matches</span></code></a>(query[, ...])</p></td>
<td><p>Find matches in the molecule for a SMARTS string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.delete_hierarchy_scheme" title="openff.toolkit.topology.Molecule.delete_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_hierarchy_scheme</span></code></a>(iter_name)</p></td>
<td><p>Remove an existing <code class="docutils literal notranslate"><span class="pre">HierarchyScheme</span></code> specified by its iterator name.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.enumerate_protomers" title="openff.toolkit.topology.Molecule.enumerate_protomers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enumerate_protomers</span></code></a>([max_states])</p></td>
<td><p>Enumerate the formal charges of a molecule to generate different protomoers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.enumerate_stereoisomers" title="openff.toolkit.topology.Molecule.enumerate_stereoisomers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enumerate_stereoisomers</span></code></a>([undefined_only, ...])</p></td>
<td><p>Enumerate the stereocenters and bonds of the current molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.enumerate_tautomers" title="openff.toolkit.topology.Molecule.enumerate_tautomers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enumerate_tautomers</span></code></a>([max_states, ...])</p></td>
<td><p>Enumerate the possible tautomers of the current molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.find_rotatable_bonds" title="openff.toolkit.topology.Molecule.find_rotatable_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_rotatable_bonds</span></code></a>([...])</p></td>
<td><p>Find all bonds classed as rotatable ignoring any matched to the <code class="docutils literal notranslate"><span class="pre">ignore_functional_groups</span></code> list.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_bson" title="openff.toolkit.topology.Molecule.from_bson"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_bson</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a BSON serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_dict" title="openff.toolkit.topology.Molecule.from_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_dict</span></code></a>(molecule_dict)</p></td>
<td><p>Create a new Molecule from a dictionary representation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_file" title="openff.toolkit.topology.Molecule.from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_file</span></code></a>(file_path[, file_format, ...])</p></td>
<td><p>Create one or more molecules from a file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_inchi" title="openff.toolkit.topology.Molecule.from_inchi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_inchi</span></code></a>(inchi[, allow_undefined_stereo, ...])</p></td>
<td><p>Construct a Molecule from a InChI representation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_iupac" title="openff.toolkit.topology.Molecule.from_iupac"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_iupac</span></code></a>(iupac_name[, toolkit_registry, ...])</p></td>
<td><p>Generate a molecule from IUPAC or common name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_json" title="openff.toolkit.topology.Molecule.from_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_json</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a JSON serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="openff.toolkit.topology.Molecule.from_mapped_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_mapped_smiles</span></code></a>(mapped_smiles[, ...])</p></td>
<td><p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from a SMILES string, ordering atoms from mappings</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_messagepack" title="openff.toolkit.topology.Molecule.from_messagepack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_messagepack</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a MessagePack serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_openeye" title="openff.toolkit.topology.Molecule.from_openeye"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_openeye</span></code></a>(oemol[, allow_undefined_stereo])</p></td>
<td><p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from an OpenEye molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_pdb_and_smiles" title="openff.toolkit.topology.Molecule.from_pdb_and_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_pdb_and_smiles</span></code></a>(file_path, smiles[, ...])</p></td>
<td><p>Create a Molecule from a pdb file and a SMILES string using RDKit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_pickle" title="openff.toolkit.topology.Molecule.from_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_pickle</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a pickle serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_polymer_pdb" title="openff.toolkit.topology.Molecule.from_polymer_pdb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_polymer_pdb</span></code></a>(file_path[, toolkit_registry])</p></td>
<td><p>Loads a polymer from a PDB file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_qcschema" title="openff.toolkit.topology.Molecule.from_qcschema"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_qcschema</span></code></a>(qca_record[, client, ...])</p></td>
<td><p>Create a Molecule from a QCArchive molecule record or dataset entry based on attached cmiles information.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_rdkit" title="openff.toolkit.topology.Molecule.from_rdkit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_rdkit</span></code></a>(rdmol[, allow_undefined_stereo, ...])</p></td>
<td><p>Create a Molecule from an RDKit molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_smiles" title="openff.toolkit.topology.Molecule.from_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_smiles</span></code></a>(smiles[, ...])</p></td>
<td><p>Construct a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from a SMILES representation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_toml" title="openff.toolkit.topology.Molecule.from_toml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_toml</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from a TOML serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_topology" title="openff.toolkit.topology.Molecule.from_topology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_topology</span></code></a>(topology)</p></td>
<td><p>Return a Molecule representation of an OpenFF Topology containing a single Molecule object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_xml" title="openff.toolkit.topology.Molecule.from_xml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_xml</span></code></a>(serialized)</p></td>
<td><p>Instantiate an object from an XML serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_yaml" title="openff.toolkit.topology.Molecule.from_yaml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_yaml</span></code></a>(serialized)</p></td>
<td><p>Instantiate from a YAML serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.generate_conformers" title="openff.toolkit.topology.Molecule.generate_conformers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_conformers</span></code></a>([toolkit_registry, ...])</p></td>
<td><p>Generate conformers for this molecule using an underlying toolkit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.generate_unique_atom_names" title="openff.toolkit.topology.Molecule.generate_unique_atom_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_unique_atom_names</span></code></a>()</p></td>
<td><p>Generate unique atom names from the element symbol and count.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.get_bond_between" title="openff.toolkit.topology.Molecule.get_bond_between"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_between</span></code></a>(i, j)</p></td>
<td><p>Returns the bond between two atoms</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.is_isomorphic_with" title="openff.toolkit.topology.Molecule.is_isomorphic_with"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_isomorphic_with</span></code></a>(other, **kwargs)</p></td>
<td><p>Check if the molecule is isomorphic with the other molecule which can be an openff.toolkit.topology.Molecule or nx.Graph().</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.nth_degree_neighbors" title="openff.toolkit.topology.Molecule.nth_degree_neighbors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nth_degree_neighbors</span></code></a>(n_degrees)</p></td>
<td><p>Return canonicalized pairs of atoms whose shortest separation is <cite>exactly</cite> n bonds.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.ordered_connection_table_hash" title="openff.toolkit.topology.Molecule.ordered_connection_table_hash"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ordered_connection_table_hash</span></code></a>()</p></td>
<td><p>Compute an ordered hash of the atoms and bonds in the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.particle" title="openff.toolkit.topology.Molecule.particle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">particle</span></code></a>(index)</p></td>
<td><p></p><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0.</span></p>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.particle_index" title="openff.toolkit.topology.Molecule.particle_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">particle_index</span></code></a>(particle)</p></td>
<td><p></p><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0.</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.perceive_residues" title="openff.toolkit.topology.Molecule.perceive_residues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">perceive_residues</span></code></a>([substructure_file_path, ...])</p></td>
<td><p>Perceive a polymer's residues and permit iterating over them.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.remap" title="openff.toolkit.topology.Molecule.remap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remap</span></code></a>(mapping_dict[, current_to_new, partial])</p></td>
<td><p>Reorder the atoms in the molecule according to the given mapping dict.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.strip_atom_stereochemistry" title="openff.toolkit.topology.Molecule.strip_atom_stereochemistry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">strip_atom_stereochemistry</span></code></a>(smarts[, ...])</p></td>
<td><p>Delete stereochemistry information for certain atoms, if it is present.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_bson" title="openff.toolkit.topology.Molecule.to_bson"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_bson</span></code></a>()</p></td>
<td><p>Return a BSON serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_dict" title="openff.toolkit.topology.Molecule.to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dict</span></code></a>()</p></td>
<td><p>Return a dictionary representation of the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_file" title="openff.toolkit.topology.Molecule.to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_file</span></code></a>(file_path, file_format[, ...])</p></td>
<td><p>Write the current molecule to a file or file-like object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_hill_formula" title="openff.toolkit.topology.Molecule.to_hill_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_hill_formula</span></code></a>()</p></td>
<td><p>Generate the Hill formula of this molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_inchi" title="openff.toolkit.topology.Molecule.to_inchi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_inchi</span></code></a>([fixed_hydrogens, toolkit_registry])</p></td>
<td><p>Create an InChI string for the molecule using the requested toolkit backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_inchikey" title="openff.toolkit.topology.Molecule.to_inchikey"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_inchikey</span></code></a>([fixed_hydrogens, toolkit_registry])</p></td>
<td><p>Create an InChIKey for the molecule using the requested toolkit backend.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_iupac" title="openff.toolkit.topology.Molecule.to_iupac"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_iupac</span></code></a>([toolkit_registry])</p></td>
<td><p>Generate IUPAC name from Molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_json" title="openff.toolkit.topology.Molecule.to_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_json</span></code></a>([indent])</p></td>
<td><p>Return a JSON serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_messagepack" title="openff.toolkit.topology.Molecule.to_messagepack"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_messagepack</span></code></a>()</p></td>
<td><p>Return a MessagePack representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_networkx" title="openff.toolkit.topology.Molecule.to_networkx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_networkx</span></code></a>()</p></td>
<td><p>Generate a NetworkX undirected graph from the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_openeye" title="openff.toolkit.topology.Molecule.to_openeye"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_openeye</span></code></a>([toolkit_registry, aromaticity_model])</p></td>
<td><p>Create an OpenEye molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_pickle" title="openff.toolkit.topology.Molecule.to_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_pickle</span></code></a>()</p></td>
<td><p>Return a pickle serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_qcschema" title="openff.toolkit.topology.Molecule.to_qcschema"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_qcschema</span></code></a>([multiplicity, conformer, extras])</p></td>
<td><p>Create a QCElemental Molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_rdkit" title="openff.toolkit.topology.Molecule.to_rdkit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_rdkit</span></code></a>([aromaticity_model, toolkit_registry])</p></td>
<td><p>Create an RDKit molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_smiles" title="openff.toolkit.topology.Molecule.to_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_smiles</span></code></a>([isomeric, explicit_hydrogens, ...])</p></td>
<td><p>Return a canonical isomeric SMILES representation of the current molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_toml" title="openff.toolkit.topology.Molecule.to_toml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_toml</span></code></a>()</p></td>
<td><p>Return a TOML serialized representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_topology" title="openff.toolkit.topology.Molecule.to_topology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_topology</span></code></a>()</p></td>
<td><p>Return an OpenFF Topology representation containing one copy of this molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_xml" title="openff.toolkit.topology.Molecule.to_xml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_xml</span></code></a>([indent])</p></td>
<td><p>Return an XML representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.to_yaml" title="openff.toolkit.topology.Molecule.to_yaml"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_yaml</span></code></a>()</p></td>
<td><p>Return a YAML serialized representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_hierarchy_schemes</span></code></a>([iter_names])</p></td>
<td><p>Infer a hierarchy from atom metadata according to the existing hierarchy schemes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.visualize" title="openff.toolkit.topology.Molecule.visualize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize</span></code></a>([backend, width, height, ...])</p></td>
<td><p>Render a visualization of the molecule in Jupyter</p></td>
</tr>
</tbody>
</table></div>
<p class="rubric">Attributes</p>
<div class="table-container autosummary longtable docutils align-default"><table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.amber_impropers" title="openff.toolkit.topology.Molecule.amber_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></p></td>
<td><p>Iterate over all impropers with trivalent centers, reporting the central atom first.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.angles" title="openff.toolkit.topology.Molecule.angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angles</span></code></a></p></td>
<td><p>Get an iterator over all i-j-k angles.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.atoms" title="openff.toolkit.topology.Molecule.atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atoms</span></code></a></p></td>
<td><p>Iterate over all Atom objects in the molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.bonds" title="openff.toolkit.topology.Molecule.bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bonds</span></code></a></p></td>
<td><p>Iterate over all Bond objects in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.conformers" title="openff.toolkit.topology.Molecule.conformers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conformers</span></code></a></p></td>
<td><p>Returns the list of conformers for this molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.has_unique_atom_names" title="openff.toolkit.topology.Molecule.has_unique_atom_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_unique_atom_names</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the molecule has unique atom names, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.hierarchy_schemes" title="openff.toolkit.topology.Molecule.hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hierarchy_schemes</span></code></a></p></td>
<td><p>The hierarchy schemes available on the molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.hill_formula" title="openff.toolkit.topology.Molecule.hill_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hill_formula</span></code></a></p></td>
<td><p>Get the Hill formula of the molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.impropers" title="openff.toolkit.topology.Molecule.impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impropers</span></code></a></p></td>
<td><p>Iterate over all improper torsions in the molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_angles" title="openff.toolkit.topology.Molecule.n_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_angles</span></code></a></p></td>
<td><p>Number of angles in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_atoms" title="openff.toolkit.topology.Molecule.n_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_atoms</span></code></a></p></td>
<td><p>The number of Atom objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_bonds" title="openff.toolkit.topology.Molecule.n_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_bonds</span></code></a></p></td>
<td><p>The number of Bond objects in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_conformers" title="openff.toolkit.topology.Molecule.n_conformers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_conformers</span></code></a></p></td>
<td><p>The number of conformers for this molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_impropers" title="openff.toolkit.topology.Molecule.n_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_impropers</span></code></a></p></td>
<td><p>Number of possible improper torsions in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_particles" title="openff.toolkit.topology.Molecule.n_particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_particles</span></code></a></p></td>
<td><p></p><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0.</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.n_propers" title="openff.toolkit.topology.Molecule.n_propers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_propers</span></code></a></p></td>
<td><p>Number of proper torsions in the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.name" title="openff.toolkit.topology.Molecule.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></a></p></td>
<td><p>The name (or title) of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.partial_charges" title="openff.toolkit.topology.Molecule.partial_charges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partial_charges</span></code></a></p></td>
<td><p>Returns the partial charges (if present) on the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.particles" title="openff.toolkit.topology.Molecule.particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">particles</span></code></a></p></td>
<td><p></p><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0.</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.propers" title="openff.toolkit.topology.Molecule.propers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propers</span></code></a></p></td>
<td><p>Iterate over all proper torsions in the molecule</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.properties" title="openff.toolkit.topology.Molecule.properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">properties</span></code></a></p></td>
<td><p>The properties dictionary of the molecule</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="openff.toolkit.topology.Molecule.smirnoff_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a></p></td>
<td><p>Iterate over all impropers with trivalent centers, reporting the central atom second.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.torsions" title="openff.toolkit.topology.Molecule.torsions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torsions</span></code></a></p></td>
<td><p>Get an iterator over all i-j-k-l torsions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openff.toolkit.topology.Molecule.total_charge" title="openff.toolkit.topology.Molecule.total_charge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_charge</span></code></a></p></td>
<td><p>Return the total charge on the molecule</p></td>
</tr>
</tbody>
</table></div>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_atom">
<span class="sig-name descname"><span class="pre">add_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomic_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">formal_charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_aromatic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereochemistry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_atom" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Add an atom to the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atomic_number</strong><span class="classifier">int</span></dt><dd><p>Atomic number of the atom</p>
</dd>
<dt><strong>formal_charge</strong><span class="classifier">int</span></dt><dd><p>Formal charge of the atom</p>
</dd>
<dt><strong>is_aromatic</strong><span class="classifier">bool</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, atom is aromatic; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, not aromatic</p>
</dd>
<dt><strong>stereochemistry</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Either <code class="docutils literal notranslate"><span class="pre">'R'</span></code> or <code class="docutils literal notranslate"><span class="pre">'S'</span></code> for specified stereochemistry, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if stereochemistry is irrelevant</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd><p>An optional name for the atom</p>
</dd>
<dt><strong>metadata</strong><span class="classifier">dict[str: (int, str)], default=None</span></dt><dd><p>An optional dictionary where keys are strings and values are strings or ints. This is intended
to record atom-level information used to inform hierarchy definition and iteration, such as
grouping atom by residue and chain.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the atom in the molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Define a methane molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'methane'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H1</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H2</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H3</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H4</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond_idx</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">H4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">explicit_hydrogens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">'C'</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_bond">
<span class="sig-name descname"><span class="pre">add_bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Atom</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Atom</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_aromatic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereochemistry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fractional_bond_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_bond" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Add a bond between two specified atom indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom1</strong><span class="classifier">int or openff.toolkit.topology.molecule.Atom</span></dt><dd><p>Index of first atom</p>
</dd>
<dt><strong>atom2</strong><span class="classifier">int or openff.toolkit.topology.molecule.Atom</span></dt><dd><p>Index of second atom</p>
</dd>
<dt><strong>bond_order</strong><span class="classifier">int</span></dt><dd><p>Integral bond order of Kekulized form</p>
</dd>
<dt><strong>is_aromatic</strong><span class="classifier">bool</span></dt><dd><p>True if this bond is aromatic, False otherwise</p>
</dd>
<dt><strong>stereochemistry</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Either <code class="docutils literal notranslate"><span class="pre">'E'</span></code> or <code class="docutils literal notranslate"><span class="pre">'Z'</span></code> for specified stereochemistry, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if stereochemistry is irrelevant</p>
</dd>
<dt><strong>fractional_bond_order</strong><span class="classifier">float, optional, default=None</span></dt><dd><p>The fractional (eg. Wiberg) bond order</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>index: int</dt><dd><p>Index of the bond in this molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For an example of use, see <a class="reference internal" href="#openff.toolkit.topology.Molecule.add_atom" title="openff.toolkit.topology.Molecule.add_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_atom()</span></code></a>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_conformer">
<span class="sig-name descname"><span class="pre">add_conformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.add_conformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_conformer" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Add a conformation of the molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates: unit-wrapped np.array with shape (n_atoms, 3) and dimension of distance</strong></dt><dd><p>Coordinates of the new conformer, with the first dimension of the array corresponding to the atom index in
the molecule’s indexing system.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>index: int</dt><dd><p>The index of this conformer</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rdkit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all_hydrogens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.visualize" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Render a visualization of the molecule in Jupyter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>backend</strong><span class="classifier">str, optional, default=’rdkit’</span></dt><dd><p>The visualization engine to use. Choose from:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">"rdkit"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"openeye"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"nglview"</span></code> (requires conformers)</p></li>
</ul>
</dd>
<dt><strong>width</strong><span class="classifier">int, optional, default=500</span></dt><dd><p>Width of the generated representation (only applicable to
<code class="docutils literal notranslate"><span class="pre">backend=openeye</span></code> or <code class="docutils literal notranslate"><span class="pre">backend=rdkit</span></code>)</p>
</dd>
<dt><strong>height</strong><span class="classifier">int, optional, default=300</span></dt><dd><p>Width of the generated representation (only applicable to
<code class="docutils literal notranslate"><span class="pre">backend=openeye</span></code> or <code class="docutils literal notranslate"><span class="pre">backend=rdkit</span></code>)</p>
</dd>
<dt><strong>show_all_hydrogens</strong><span class="classifier">bool, optional, default=True</span></dt><dd><p>Whether to explicitly depict all hydrogen atoms. (only applicable to
<code class="docutils literal notranslate"><span class="pre">backend=openeye</span></code> or <code class="docutils literal notranslate"><span class="pre">backend=rdkit</span></code>)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>object</dt><dd><p>Depending on the backend chosen:</p>
<ul class="simple">
<li><p>rdkit → IPython.display.SVG</p></li>
<li><p>openeye → IPython.display.Image</p></li>
<li><p>nglview → nglview.NGLWidget</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.perceive_residues">
<span class="sig-name descname"><span class="pre">perceive_residues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substructure_file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_chirality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/openff/toolkit/topology/molecule.html#Molecule.perceive_residues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#openff.toolkit.topology.Molecule.perceive_residues" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Perceive a polymer’s residues and permit iterating over them.</p>
<p>Perceives residues by matching substructures in the current molecule
with a substructure dictionary file, using SMARTS, and assigns residue
names and numbers to atom metadata. It then constructs a residue hierarchy
scheme to allow iterating over residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>substructure_file_path</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Path to substructure library file in JSON format. Defaults to using
built-in substructure file.</p>
</dd>
<dt><strong>strict_chirality: bool, optional, default=True</strong></dt><dd><p>Whether to use strict chirality symbols (stereomarks) for
substructure matchings with SMARTS.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_default_hierarchy_schemes">
<span class="sig-name descname"><span class="pre">add_default_hierarchy_schemes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overwrite_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_default_hierarchy_schemes" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Adds <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">residue</span></code> hierarchy schemes.</p>
<p>The Open Force Field Toolkit has no native understanding of hierarchical
atom organisation schemes common to other biomolecular software, such as
“residues” or “chains” (see <span class="xref std std-ref">userguide_hierarchy</span>). Hierarchy
schemes allow iteration over groups of atoms according to their
metadata. For more information, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchyScheme</span></code>.</p>
<p>If a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> with the default hierarchy schemes
changes, <a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.update_hierarchy_schemes()</span></code></a> must be called before
the residues or chains are iterated over again or else the iteration may
be incorrect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>overwrite_existing</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to overwrite existing instances of the <cite>residue</cite> and <cite>chain</cite>
hierarchy schemes. If this is <code class="docutils literal notranslate"><span class="pre">False</span></code> and either of the hierarchy
schemes are already defined on this molecule, an exception will be
raised.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>HierarchySchemeWithIteratorNameAlreadyRegisteredException</dt><dd><p>When <code class="docutils literal notranslate"><span class="pre">overwrite_existing=False</span></code> and either the <code class="docutils literal notranslate"><span class="pre">chains</span></code> or
<code class="docutils literal notranslate"><span class="pre">residues</span></code> hierarchy scheme is already configured.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">HierarchyScheme</span></code>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.add_hierarchy_scheme" title="openff.toolkit.topology.Molecule.add_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.add_hierarchy_scheme</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.update_hierarchy_schemes</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.perceive_residues" title="openff.toolkit.topology.Molecule.perceive_residues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.perceive_residues</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.add_hierarchy_scheme">
<span class="sig-name descname"><span class="pre">add_hierarchy_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uniqueness_criteria</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.add_hierarchy_scheme" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Use the molecule’s metadata to facilitate iteration over its atoms.</p>
<p>This method will add an attribute with the name given by the
<code class="docutils literal notranslate"><span class="pre">iterator_name</span></code> argument that provides an iterator over groups of
atoms. Atoms are grouped by the values in their <code class="docutils literal notranslate"><span class="pre">atom.metadata</span></code>
dictionary; any atoms with the same values for the keys given in the
<code class="docutils literal notranslate"><span class="pre">uniqueness_criteria</span></code> argument will be in the same group. These groups
have the type <code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchyElement</span></code>.</p>
<p>Hierarchy schemes are not updated dynamically; if a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> with
hierarchy schemes changes, <a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.update_hierarchy_schemes()</span></code></a> must
be called before the scheme is iterated over again or else the grouping
may be incorrect.</p>
<p>Hierarchy schemes allow iteration over groups of atoms according to
their metadata. For more information, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchyScheme</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>uniqueness_criteria</strong><span class="classifier">tuple of str</span></dt><dd><p>The names of <code class="docutils literal notranslate"><span class="pre">Atom</span></code> metadata entries that define this scheme. An
atom belongs to a <code class="docutils literal notranslate"><span class="pre">HierarchyElement</span></code> only if its metadata has the
same values for these criteria as the other atoms in the
<code class="docutils literal notranslate"><span class="pre">HierarchyElement</span></code>.</p>
</dd>
<dt><strong>iterator_name</strong><span class="classifier">str</span></dt><dd><p>Name of the iterator that will be exposed to access the hierarchy
elements generated by this scheme.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>new_hier_scheme</strong><span class="classifier">openff.toolkit.topology.HierarchyScheme</span></dt><dd><p>The newly created HierarchyScheme</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_default_hierarchy_schemes" title="openff.toolkit.topology.Molecule.add_default_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.add_default_hierarchy_schemes</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.hierarchy_schemes" title="openff.toolkit.topology.Molecule.hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.hierarchy_schemes</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.delete_hierarchy_scheme" title="openff.toolkit.topology.Molecule.delete_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.delete_hierarchy_scheme</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.update_hierarchy_schemes</span></code></a></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">HierarchyScheme</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.amber_impropers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">amber_impropers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.amber_impropers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Iterate over all impropers with trivalent centers, reporting the central atom first.</p>
<p>The central atom is reported first in each torsion. This method reports
an improper for each trivalent atom in the molecule, whether or not any
given force field would assign it improper torsion parameters.</p>
<p>Also note that this will return 6 possible atom orderings around each
improper center. In current AMBER parameterization, one of these six
orderings will be used for the actual assignment of the improper term
and measurement of the angle. This method does not encode the logic to
determine which of the six orderings AMBER would use.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>impropers</strong><span class="classifier">set of tuple</span></dt><dd><p>An iterator of tuples, each containing the indices of atoms making
up a possible improper torsion. The central atom is listed first in
each tuple.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.impropers" title="openff.toolkit.topology.Molecule.impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impropers</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="openff.toolkit.topology.Molecule.smirnoff_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.angles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Get an iterator over all i-j-k angles.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.apply_elf_conformer_selection">
<span class="sig-name descname"><span class="pre">apply_elf_conformer_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.apply_elf_conformer_selection" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Select a set of diverse conformers from the molecule’s conformers with ELF.</p>
<p>Applies the <a class="reference external" href="https://docs.eyesopen.com/toolkits/python/quacpactk/molchargetheory.html#elf-conformer-selection">Electrostatically Least-interacting Functional groups method</a>
to select a set of diverse conformers which have minimal
electrostatically strongly interacting functional groups from the
molecule’s conformers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong></dt><dd><p>The underlying toolkit to use to select the ELF conformers.</p>
</dd>
<dt><strong>percentage</strong></dt><dd><p>The percentage of conformers with the lowest electrostatic
interaction energies to greedily select from.</p>
</dd>
<dt><strong>limit</strong></dt><dd><p>The maximum number of conformers to select.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">openff.toolkit.utils.toolkits.OpenEyeToolkitWrapper.apply_elf_conformer_selection</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">openff.toolkit.utils.toolkits.RDKitToolkitWrapper.apply_elf_conformer_selection</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The input molecule should have a large set of conformers already
generated to select the ELF conformers from.</p></li>
<li><p>The selected conformers will be retained in the <cite>conformers</cite> list
while unselected conformers will be discarded.</p></li>
</ul>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.are_isomorphic">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">are_isomorphic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">FrozenMolecule</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">FrozenMolecule</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_atom_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aromatic_matching</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formal_charge_matching</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_order_matching</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_stereochemistry_matching</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereochemistry_matching</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strip_pyrimidal_n_atom_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.are_isomorphic" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Determine if <code class="docutils literal notranslate"><span class="pre">mol1</span></code> is isomorphic to <code class="docutils literal notranslate"><span class="pre">mol2</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">are_isomorphic()</span></code> compares two molecule’s graph representations and
the chosen node/edge attributes. Connections and atomic numbers are
always checked.</p>
<p>If nx.Graphs() are given they must at least have <code class="docutils literal notranslate"><span class="pre">atomic_number</span></code>
attributes on nodes. Other attributes that <code class="docutils literal notranslate"><span class="pre">are_isomorphic()</span></code> can
optionally check…</p>
<ul class="simple">
<li><p>… in nodes are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">is_aromatic</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">formal_charge</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stereochemistry</span></code></p></li>
</ul>
</li>
<li><p>… in edges are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">is_aromatic</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bond_order</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stereochemistry</span></code></p></li>
</ul>
</li>
</ul>
<p>By default, all attributes are checked, but stereochemistry around
pyrimidal nitrogen is ignored.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mol1</strong><span class="classifier">an openff.toolkit.topology.molecule.FrozenMolecule or nx.Graph()</span></dt><dd><p>The first molecule to test for isomorphism.</p>
</dd>
<dt><strong>mol2</strong><span class="classifier">an openff.toolkit.topology.molecule.FrozenMolecule or nx.Graph()</span></dt><dd><p>The second molecule to test for isomorphism.</p>
</dd>
<dt><strong>return_atom_map: bool, default=False, optional</strong></dt><dd><p>Return a <code class="docutils literal notranslate"><span class="pre">dict</span></code> containing the atomic mapping instead of a
<code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p>
</dd>
<dt><strong>aromatic_matching: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, aromaticity of graph nodes and edges are ignored for
the purpose of determining isomorphism.</p>
</dd>
<dt><strong>formal_charge_matching: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, formal charges of graph nodes are ignored for
the purpose of determining isomorphism.</p>
</dd>
<dt><strong>bond_order_matching: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, bond orders of graph edges are ignored for
the purpose of determining isomorphism.</p>
</dd>
<dt><strong>atom_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, atoms’ stereochemistry is ignored for the
purpose of determining isomorphism.</p>
</dd>
<dt><strong>bond_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, bonds’ stereochemistry is ignored for the
purpose of determining isomorphism.</p>
</dd>
<dt><strong>strip_pyrimidal_n_atom_stereo: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, any stereochemistry defined around pyrimidal
nitrogen stereocenters will be disregarded in the isomorphism
check.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for
removing stereochemistry from pyrimidal nitrogens.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecules_are_isomorphic</strong><span class="classifier">bool</span></dt><dd></dd>
<dt><strong>atom_map</strong><span class="classifier">default=None, Optional,</span></dt><dd><p>[Dict[int,int]] ordered by mol1 indexing {mol1_index: mol2_index}
If molecules are not isomorphic given input arguments, will return None instead of dict.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.assign_fractional_bond_orders">
<span class="sig-name descname"><span class="pre">assign_fractional_bond_orders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_order_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_conformers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.assign_fractional_bond_orders" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Update and store list of bond orders this molecule.</p>
<p>Bond orders are stored on each bond, in the
<code class="docutils literal notranslate"><span class="pre">bond.fractional_bond_order</span></code> attribute.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>bond_order_model</strong><span class="classifier">string, optional. Default=None</span></dt><dd><p>The bond order model to use for fractional bond order calculation. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">"am1-wiberg"</span></code> is used.</p>
</dd>
<dt><strong>use_conformers</strong><span class="classifier">iterable of openff.unit.Quantity(np.array) with shape (n_atoms, 3) and dimension of distance,</span></dt><dd><p>optional, default=None
The conformers to use for fractional bond order calculation. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an appropriate number
of conformers will be generated by an available <code class="docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'CCCCCC'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">assign_fractional_bond_orders</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.assign_partial_charges">
<span class="sig-name descname"><span class="pre">assign_partial_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partial_charge_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_n_conformers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_conformers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Quantity</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_partial_charges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.assign_partial_charges" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Calculate partial atomic charges and store them in the molecule.</p>
<p><code class="docutils literal notranslate"><span class="pre">assign_partial_charges</span></code> computes charges using the specified toolkit
and assigns the new values to the <code class="docutils literal notranslate"><span class="pre">partial_charges</span></code> attribute.
Supported charge methods vary from toolkit to toolkit, but some
supported methods are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">"am1bcc"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"am1bccelf10"</span></code> (requires OpenEye Toolkits)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"am1-mulliken"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"mmff94"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">"gasteiger"</span></code></p></li>
</ul>
<p>For more supported charge methods and details, see the corresponding
methods in each toolkit wrapper:</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">OpenEyeToolkitWrapper.assign_partial_charges</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">RDKitToolkitWrapper.assign_partial_charges</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">AmberToolsToolkitWrapper.assign_partial_charges</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">BuiltInToolkitWrapper.assign_partial_charges</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>partial_charge_method</strong><span class="classifier">string</span></dt><dd><p>The partial charge calculation method to use for partial charge
calculation.</p>
</dd>
<dt><strong>strict_n_conformers</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to raise an exception if an invalid number of conformers is
provided for the given charge method. If this is False and an
invalid number of conformers is found, a warning will be raised.</p>
</dd>
<dt><strong>use_conformers</strong><span class="classifier">iterable of openff.unit.Quantity-wrapped numpy arrays, each with shape (n_atoms, 3) and</span></dt><dd><p>dimension of distance. Optional, default=None
Coordinates to use for partial charge calculation. If None, an
appropriate number of conformers will be generated.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper,
optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for the
calculation.</p>
</dd>
<dt><strong>normalize_partial_charges</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to offset partial charges so that they sum to the total
formal charge of the molecule. This is used to prevent accumulation
of rounding errors when the partial charge assignment method returns
values at limited precision.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">openff.toolkit.utils.toolkits.OpenEyeToolkitWrapper.assign_partial_charges</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">openff.toolkit.utils.toolkits.RDKitToolkitWrapper.assign_partial_charges</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">openff.toolkit.utils.toolkits.AmberToolsToolkitWrapper.assign_partial_charges</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">openff.toolkit.utils.toolkits.BuiltInToolkitWrapper.assign_partial_charges</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'CCCCCC'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">assign_partial_charges</span><span class="p">(</span><span class="s1">'am1-mulliken'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.atom">
<span class="sig-name descname"><span class="pre">atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Atom</span></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.atom" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Get the atom with the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>atom</strong><span class="classifier">openff.toolkit.topology.Atom</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.atom_index">
<span class="sig-name descname"><span class="pre">atom_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atom</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.atom_index" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Returns the index of the given atom in this molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom</strong><span class="classifier">openff.toolkit.topology.Atom</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd><p>The index of the given atom in this molecule</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.atoms" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Iterate over all Atom objects in the molecule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.bond">
<span class="sig-name descname"><span class="pre">bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Bond</span></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.bond" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Get the bond with the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>index</strong><span class="classifier">int</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>bond</strong><span class="classifier">openff.toolkit.topology.Bond</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.bonds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bonds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Bond</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.bonds" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Iterate over all Bond objects in the molecule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.canonical_order_atoms">
<span class="sig-name descname"><span class="pre">canonical_order_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.canonical_order_atoms" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Produce a copy of the molecule with the atoms reordered canonically.</p>
<p>Each toolkit defines its own canonical ordering of atoms. The canonical
order may change from toolkit version to toolkit version or between
toolkits.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper, optional
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for
SMILES-to-molecule conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An new OpenFF style molecule with atoms in the canonical order.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.chemical_environment_matches">
<span class="sig-name descname"><span class="pre">chemical_environment_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.chemical_environment_matches" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Find matches in the molecule for a SMARTS string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>query</strong><span class="classifier">str</span></dt><dd><p>SMARTS string (with one or more tagged atoms).</p>
</dd>
<dt><strong>unique</strong><span class="classifier">bool, default=False</span></dt><dd></dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for chemical environment matches</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>matches</strong><span class="classifier">list of atom index tuples</span></dt><dd><p>A list of tuples, containing the indices of the matching atoms.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Retrieve all the carbon-carbon bond matches in a molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'imatinib'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">chemical_environment_matches</span><span class="p">(</span><span class="s1">'[#6X3:1]~[#6X3:2]'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we want to generalize <code class="docutils literal notranslate"><span class="pre">query</span></code> to allow other kinds of queries,
such as mdtraj DSL, pymol selections, atom index slices, etc? We
could call it <code class="docutils literal notranslate"><span class="pre">topology.matches(query)</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">chemical_environment_matches</span></code></p></li>
</ul>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.conformers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conformers</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.conformers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Returns the list of conformers for this molecule.</p>
<p>Conformers are presented as a list of <code class="docutils literal notranslate"><span class="pre">Quantity</span></code>-wrapped NumPy
arrays, of shape (3 x n_atoms) and with dimensions of [Distance]. The
return value is the actual list of conformers, and changes to the
contents affect the original <code class="docutils literal notranslate"><span class="pre">FrozenMolecule</span></code>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.delete_hierarchy_scheme">
<span class="sig-name descname"><span class="pre">delete_hierarchy_scheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.delete_hierarchy_scheme" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Remove an existing <code class="docutils literal notranslate"><span class="pre">HierarchyScheme</span></code> specified by its iterator name.</p>
<p>Hierarchy schemes allow iteration over groups of atoms according to
their metadata. For more information, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchyScheme</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iter_name</strong><span class="classifier">str</span></dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_hierarchy_scheme" title="openff.toolkit.topology.Molecule.add_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.add_hierarchy_scheme</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.update_hierarchy_schemes</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.hierarchy_schemes" title="openff.toolkit.topology.Molecule.hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.hierarchy_schemes</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">HierarchyScheme</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.enumerate_protomers">
<span class="sig-name descname"><span class="pre">enumerate_protomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.enumerate_protomers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Enumerate the formal charges of a molecule to generate different protomoers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_states: int optional, default=10,</strong></dt><dd><p>The maximum number of protomer states to be returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>molecules: List[openff.toolkit.topology.Molecule],</dt><dd><p>A list of the protomers of the input molecules not including the input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.enumerate_stereoisomers">
<span class="sig-name descname"><span class="pre">enumerate_stereoisomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">undefined_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_isomers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rationalise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.enumerate_stereoisomers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Enumerate the stereocenters and bonds of the current molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>undefined_only: bool optional, default=False</strong></dt><dd><p>If we should enumerate all stereocenters and bonds or only those with undefined stereochemistry</p>
</dd>
<dt><strong>max_isomers: int optional, default=20</strong></dt><dd><p>The maximum amount of molecules that should be returned</p>
</dd>
<dt><strong>rationalise: bool optional, default=True</strong></dt><dd><p>If we should try to build and rationalise the molecule to ensure it can exist</p>
</dd>
<dt><strong>toolkit_registry: openff.toolkit.utils.toolkits.ToolkitRegistry or</strong></dt><dd><p>lopenff.toolkit.utils.toolkits.ToolkitWrapper, default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use to enumerate the stereoisomers.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>molecules: List[openff.toolkit.topology.Molecule]</dt><dd><p>A list of <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instances not including the input molecule.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.enumerate_tautomers">
<span class="sig-name descname"><span class="pre">enumerate_tautomers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.enumerate_tautomers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Enumerate the possible tautomers of the current molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_states: int optional, default=20</strong></dt><dd><p>The maximum amount of molecules that should be returned</p>
</dd>
<dt><strong>toolkit_registry: openff.toolkit.utils.toolkits.ToolkitRegistry</strong></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use to enumerate the tautomers.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>molecules: List[openff.toolkit.topology.Molecule]</dt><dd><p>A list of openff.toolkit.topology.Molecule instances not including the input molecule.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.find_rotatable_bonds">
<span class="sig-name descname"><span class="pre">find_rotatable_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_functional_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.find_rotatable_bonds" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Find all bonds classed as rotatable ignoring any matched to the <code class="docutils literal notranslate"><span class="pre">ignore_functional_groups</span></code> list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ignore_functional_groups: optional, List[str], default=None,</strong></dt><dd><p>A list of bond SMARTS patterns to be ignored when finding rotatable bonds.</p>
</dd>
<dt><strong>toolkit_registry: openff.toolkit.utils.toolkits.ToolkitRegistry</strong></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapperl, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMARTS matching</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bonds: List[openff.toolkit.topology.molecule.Bond]</dt><dd><p>The list of openff.toolkit.topology.molecule.Bond instances which are rotatable.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_bson">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_bson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_bson" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate an object from a BSON serialized representation.</p>
<p>Specification: <a class="reference external" href="http://bsonspec.org/">http://bsonspec.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A BSON serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_dict" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a new Molecule from a dictionary representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecule_dict</strong><span class="classifier">dict</span></dt><dd><p>A dictionary representation of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">Molecule</span></dt><dd><p>A Molecule created from the dictionary representation</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry=&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AmberTools</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_file" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create one or more molecules from a file</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Extend this to also include some form of .offmol Open Force Field Molecule format?</p></li>
<li><p>Generalize this to also include file-like objects?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path</strong><span class="classifier">str or file-like object</span></dt><dd><p>The path to the file or file-like object to stream one or more molecules from.</p>
</dd>
<dt><strong>file_format</strong><span class="classifier">str, optional, default=None</span></dt><dd><p>Format specifier, usually file suffix (eg. ‘MOL2’, ‘SMI’)
Note that not all toolkits support all formats. Check ToolkitWrapper.toolkit_file_read_formats for your
loaded toolkits for details.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for file loading. If a Toolkit is passed, only
the highest-precedence toolkit is used</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecules</strong><span class="classifier">Molecule or list of Molecules</span></dt><dd><p>If there is a single molecule in the file, a Molecule is returned;
otherwise, a list of Molecule objects is returned.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_file_path</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s2">"molecules/toluene.sdf"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">sdf_file_path</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_inchi">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_inchi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inchi:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry:</span> <span class="pre">~typing.Union[~openff.toolkit.utils.toolkit_registry.ToolkitRegistry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~openff.toolkit.utils.base_wrapper.ToolkitWrapper]</span> <span class="pre">=</span> <span class="pre">&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AmberTools</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_inchi" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Construct a Molecule from a InChI representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inchi</strong><span class="classifier">str</span></dt><dd><p>The InChI representation of the molecule.</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to accept InChI with undefined stereochemistry. If False,
an exception will be raised if a InChI with undefined stereochemistry
is passed into this function.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for InChI-to-molecule conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Make cis-1,2-Dichloroethene:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_inchi</span><span class="p">(</span><span class="s1">'InChI=1S/C2H2Cl2/c3-1-2-4/h1-2H/b2-1-'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_iupac">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_iupac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iupac_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry=&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AmberTools</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_iupac" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Generate a molecule from IUPAC or common name</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method requires the OpenEye toolkit to be installed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iupac_name</strong><span class="classifier">str</span></dt><dd><p>IUPAC name of molecule to be generated</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for chemical environment matches</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if molecule contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">Molecule</span></dt><dd><p>The resulting molecule with position</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a molecule from an IUPAC name</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'4-[(4-methylpiperazin-1-yl)methyl]-N-(4-methyl-3-{[4-(pyridin-3-yl)pyrimidin-2-yl]amino}phenyl)benzamide'</span><span class="p">)</span>  <span class="c1"># noqa</span>
</pre></div>
</div>
<p>Create a molecule from a common name</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'imatinib'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_json" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate an object from a JSON serialized representation.</p>
<p>Specification: <a class="reference external" href="https://www.json.org/">https://www.json.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A JSON serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_mapped_smiles">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_mapped_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapped_smiles:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry:</span> <span class="pre">~typing.Union[~openff.toolkit.utils.toolkit_registry.ToolkitRegistry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~openff.toolkit.utils.base_wrapper.ToolkitWrapper]</span> <span class="pre">=</span> <span class="pre">&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AmberTools</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from a SMILES string, ordering atoms from mappings</p>
<p>SMILES strings support mapping integer indices to each atom by ending a
bracketed atom declaration with a colon followed by a 1-indexed
integer:</p>
<p>This method creates a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from such a SMILES string whose atoms
are ordered according to the mapping. Each atom must be mapped exactly
once; any duplicate, missing, or out-of-range mappings will cause the
method to fail.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mapped_smiles: str</strong></dt><dd><p>A mapped SMILES string with explicit hydrogens.</p>
</dd>
<dt><strong>toolkit_registry</strong></dt><dd><p>Cheminformatics toolkit to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>allow_undefined_stereo</strong></dt><dd><p>If false, raise an exception if the SMILES contains undefined
stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>offmol</dt><dd><p>An OpenFF molecule instance.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>SmilesParsingError</dt><dd><p>If the given SMILES had no indexing picked up by the toolkits, or if
the indexing is missing indices.</p>
</dd>
<dt>RemapIndexError</dt><dd><p>If the mapping has duplicate or out-of-range indices.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_smiles" title="openff.toolkit.topology.Molecule.from_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_smiles</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.remap" title="openff.toolkit.topology.Molecule.remap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remap</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Create a mapped chlorofluoroiodomethane molecule and check the atoms
are placed accordingly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_mapped_smiles</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">"[Cl:2][C@:1]([F:3])([I:4])[H:5]"</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">"C"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">"Cl"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">"F"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">"I"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">"H"</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_messagepack">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_messagepack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_messagepack" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate an object from a MessagePack serialized representation.</p>
<p>Specification: <a class="reference external" href="https://msgpack.org/index.html">https://msgpack.org/index.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A MessagePack-encoded bytes serialized representation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>Instantiated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_openeye">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_openeye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oemol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_openeye" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from an OpenEye molecule.</p>
<p>Requires the OpenEye toolkit to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>oemol</strong><span class="classifier">openeye.oechem.OEMol</span></dt><dd><p>An OpenEye molecule</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, raises an exception if oemol contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An OpenFF molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from an OpenEye OEMol</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openeye</span> <span class="kn">import</span> <span class="n">oechem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">oechem</span><span class="o">.</span><span class="n">OEMol</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oechem</span><span class="o">.</span><span class="n">OESmilesToMol</span><span class="p">(</span><span class="n">oemol</span><span class="p">,</span> <span class="s1">'[H]C([H])([H])C([H])([H])O[H]'</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_openeye</span><span class="p">(</span><span class="n">oemol</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_pdb_and_smiles">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pdb_and_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_pdb_and_smiles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a Molecule from a pdb file and a SMILES string using RDKit.</p>
<p>Requires RDKit to be installed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<p>The molecule is created and sanitised based on the SMILES string, we then find a mapping
between this molecule and one from the PDB based only on atomic number and connections.
The SMILES molecule is then reindexed to match the PDB, the conformer is attached, and the
molecule returned.</p>
<p>Note that any stereochemistry in the molecule is set by the SMILES, and not the coordinates
of the PDB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path: str</strong></dt><dd><p>PDB file path</p>
</dd>
<dt><strong>smiles</strong><span class="classifier">str</span></dt><dd><p>a valid smiles string for the pdb, used for stereochemistry, formal charges, and bond order</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if SMILES contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.Molecule</span></dt><dd><p>An OFFMol instance with ordering the same as used in the PDB file.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>InvalidConformerError</dt><dd><p>If the SMILES and PDB molecules are not isomorphic.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_pickle">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_pickle" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate an object from a pickle serialized representation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not recommended for safe, stable storage since the pickle specification
may change between Python versions.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A pickled representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_polymer_pdb">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_polymer_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">file_path:</span> <span class="pre">~typing.Union[str,</span> <span class="pre">~typing.TextIO],</span> <span class="pre">toolkit_registry=&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit,</span> <span class="pre">AmberTools,</span> <span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_polymer_pdb" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Loads a polymer from a PDB file.</p>
<p>Currently only supports proteins with canonical amino acids that are
either uncapped or capped by ACE/NME groups, but may later be extended
to handle other common polymers, or accept user-defined polymer
templates. Only one polymer chain may be present in the PDB file, and it
must be the only molecule present.</p>
<p>Connectivity and bond orders are assigned by matching SMARTS codes for
the supported residues against atom names. The PDB file must include
all atoms with the correct standard atom names described in the
<a class="reference external" href="https://www.wwpdb.org/data/ccd">PDB Chemical Component Dictionary</a>.
Residue names are used to assist trouble-shooting failed assignments,
but are not used in the actual assignment process.</p>
<p>Metadata such as residues, chains, and atom names are recorded in the
<code class="docutils literal notranslate"><span class="pre">Atom.metadata</span></code> attribute, which is a dictionary mapping from
strings like “residue_name” to the appropriate value. <code class="docutils literal notranslate"><span class="pre">from_polymer_pdb</span></code>
returns a molecule that can be iterated over with the <code class="docutils literal notranslate"><span class="pre">.residues</span></code> and
<code class="docutils literal notranslate"><span class="pre">.chains</span></code> attributes, as well as the usual <code class="docutils literal notranslate"><span class="pre">.atoms</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path</strong><span class="classifier">str or file object</span></dt><dd><p>PDB information to be passed to OpenMM PDBFile object for loading</p>
</dd>
<dt><strong>toolkit_registry = ToolkitWrapper or ToolkitRegistry. Default = None</strong></dt><dd><p>Either a ToolkitRegistry, ToolkitWrapper</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>UnassignedChemistryInPDBError</dt><dd><p>If an atom or bond could not be assigned; the exception will
provide a detailed diagnostic of what went wrong.</p>
</dd>
<dt>MultipleMoleculesInPDBError</dt><dd><p>If all atoms and bonds could be assigned, but the PDB includes
multiple chains or molecules.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_qcschema">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_qcschema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qca_record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry=&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AmberTools</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_qcschema" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a Molecule from a QCArchive molecule record or dataset entry
based on attached cmiles information.</p>
<p>For a molecule record, a conformer will be set from its geometry.</p>
<p>For a dataset entry, if a corresponding client instance is provided,
the starting geometry for that entry will be used as a conformer.</p>
<p>A QCElemental Molecule produced from <code class="docutils literal notranslate"><span class="pre">Molecule.to_qcschema</span></code> can be round-tripped
through this method to produce a new, valid Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>qca_record</strong><span class="classifier">dict</span></dt><dd><p>A QCArchive molecule record or dataset entry.</p>
</dd>
<dt><strong>client</strong><span class="classifier">optional, default=None,</span></dt><dd><p>A qcportal.FractalClient instance to use for fetching an initial geometry.
Only used if <code class="docutils literal notranslate"><span class="pre">qca_record</span></code> is a dataset entry.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper, optional
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If false, raises an exception if qca_record contains undefined stereochemistry.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An OpenFF molecule instance.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>AttributeError</dt><dd><p>If the record dict can not be made from <code class="docutils literal notranslate"><span class="pre">qca_record</span></code>, or if the
provided <code class="docutils literal notranslate"><span class="pre">client</span></code> could not retrieve the initial molecule.</p>
</dd>
<dt>KeyError</dt><dd><p>If the record does not contain the
<code class="docutils literal notranslate"><span class="pre">canonical_isomeric_explicit_hydrogen_mapped_smiles</span></code>.</p>
</dd>
<dt>InvalidConformerError</dt><dd><p>Silent error, if the conformer could not be attached.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Get Molecule from a QCArchive molecule record:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qcportal</span> <span class="kn">import</span> <span class="n">FractalClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">FractalClient</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="o">.</span><span class="n">query_molecules</span><span class="p">(</span><span class="n">molecular_formula</span><span class="o">=</span><span class="s2">"C16H20N3O5"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Get Molecule from a QCArchive optimization entry:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qcportal</span> <span class="kn">import</span> <span class="n">FractalClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">FractalClient</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optds</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">"OptimizationDataset"</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">"SMIRNOFF Coverage Set 1"</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span><span class="n">optds</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="s1">'coc(o)oc-0'</span><span class="p">))</span>
</pre></div>
</div>
<p>Same as above, but with conformer(s) from initial molecule(s) by
providing client to database:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">offmol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">optds</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="s1">'coc(o)oc-0'</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">client</span><span class="o">=</span><span class="n">client</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_rdkit">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_rdkit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdmol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogens_are_explicit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_rdkit" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a Molecule from an RDKit molecule.</p>
<p>Requires the RDKit to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rdmol</strong><span class="classifier">rkit.RDMol</span></dt><dd><p>An RDKit molecule</p>
</dd>
<dt><strong>allow_undefined_stereo</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, raises an exception if <code class="docutils literal notranslate"><span class="pre">rdmol</span></code> contains undefined stereochemistry.</p>
</dd>
<dt><strong>hydrogens_are_explicit</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, RDKit will perform hydrogen addition using <code class="docutils literal notranslate"><span class="pre">Chem.AddHs</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>An OpenFF molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a molecule from an RDKit molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">"CCO"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_rdkit</span><span class="p">(</span><span class="n">rdmol</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_smiles">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogens_are_explicit:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry:</span> <span class="pre">~typing.Union[~openff.toolkit.utils.toolkit_registry.ToolkitRegistry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~openff.toolkit.utils.base_wrapper.ToolkitWrapper]</span> <span class="pre">=</span> <span class="pre">&lt;ToolkitRegistry</span> <span class="pre">containing</span> <span class="pre">The</span> <span class="pre">RDKit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AmberTools</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Built-in</span> <span class="pre">Toolkit&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_undefined_stereo:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.molecule.Molecule"><span class="pre">Molecule</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_smiles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Construct a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> from a SMILES representation</p>
<p>The order of atoms in the <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> is unspecified and may change
from version to version or with different toolkits. SMILES atom
indices (also known as atom maps) are not used to order atoms; instead,
they are stored in the produced molecule’s properties attribute,
accessible via <code class="docutils literal notranslate"><span class="pre">molecule.properties["atom_map"]</span></code>. The atom map is
stored as a dictionary mapping molecule atom indices to SMILES atom
maps. To order atoms according to SMILES atom indices, see
<a class="reference internal" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="openff.toolkit.topology.Molecule.from_mapped_smiles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.from_mapped_smiles()</span></code></a>, which helpfully raises an
exception if any atom map is missing, duplicated, or out-of-range,
or else <a class="reference internal" href="#openff.toolkit.topology.Molecule.remap" title="openff.toolkit.topology.Molecule.remap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.remap()</span></code></a> for arbitrary remaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>smiles</strong></dt><dd><p>The SMILES representation of the molecule.</p>
</dd>
<dt><strong>hydrogens_are_explicit</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, forbid the cheminformatics toolkit from inferring
hydrogen atoms not explicitly specified in the SMILES.</p>
</dd>
<dt><strong>toolkit_registry</strong></dt><dd><p>The cheminformatics toolkit to use to interpret the SMILES.</p>
</dd>
<dt><strong>allow_undefined_stereo</strong></dt><dd><p>Whether to accept SMILES with undefined stereochemistry. If
<code class="docutils literal notranslate"><span class="pre">False</span></code>, an exception will be raised if a SMILES with undefined
stereochemistry is passed into this function.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>RadicalsNotSupportedError</dt><dd><p>If any atoms in the input molecule contain radical electrons.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="openff.toolkit.topology.Molecule.from_mapped_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_mapped_smiles</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.remap" title="openff.toolkit.topology.Molecule.remap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remap</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> representing toluene from SMILES:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'Cc1ccccc1'</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> representing phenol from SMILES with the oxygen
at atom index 0 (SMILES indices begin at 1):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'c1ccccc1[OH:1]'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">remap</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">molecule</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">"atom_map"</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
<span class="gp">... </span>    <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">molecule</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">"O"</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_toml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_toml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_toml" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate an object from a TOML serialized representation.</p>
<p>Specification: <a class="reference external" href="https://github.com/toml-lang/toml">https://github.com/toml-lang/toml</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serlialized</strong><span class="classifier">str</span></dt><dd><p>A TOML serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>An instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_topology">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_topology" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a Molecule representation of an OpenFF Topology containing a single Molecule object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>topology</strong><span class="classifier">openff.toolkit.topology.Topology</span></dt><dd><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code> object containing a single <a class="reference internal" href="#openff.toolkit.topology.Molecule" title="openff.toolkit.topology.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object.
Note that OpenMM and MDTraj <code class="docutils literal notranslate"><span class="pre">Topology</span></code> objects are not supported.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>molecule</strong><span class="classifier">openff.toolkit.topology.Molecule</span></dt><dd><p>The Molecule object in the topology</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the topology does not contain exactly one molecule.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a molecule from a Topology object that contains exactly one molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit</span> <span class="kn">import</span> <span class="n">Molecule</span><span class="p">,</span> <span class="n">Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topology</span> <span class="o">=</span> <span class="n">Topology</span><span class="o">.</span><span class="n">from_molecules</span><span class="p">(</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'[CH4]'</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_topology</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_xml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_xml" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate an object from an XML serialized representation.</p>
<p>Specification: <a class="reference external" href="https://www.w3.org/XML/">https://www.w3.org/XML/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>An XML serialized representation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>Instantiated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.from_yaml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">serialized</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.from_yaml" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Instantiate from a YAML serialized representation.</p>
<p>Specification: <a class="reference external" href="http://yaml.org/">http://yaml.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A YAML serialized representation of the object</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>instance</strong><span class="classifier">cls</span></dt><dd><p>Instantiated object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.generate_conformers">
<span class="sig-name descname"><span class="pre">generate_conformers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_conformers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Quantity</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_existing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_carboxylic_acids_cis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.generate_conformers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Generate conformers for this molecule using an underlying toolkit.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n_conformers=0</span></code>, no toolkit wrapper will be called. If <code class="docutils literal notranslate"><span class="pre">n_conformers=0</span></code>
and <code class="docutils literal notranslate"><span class="pre">clear_existing=True</span></code>, <code class="docutils literal notranslate"><span class="pre">molecule.conformers</span></code> will be set to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES-to-molecule conversion</p>
</dd>
<dt><strong>n_conformers</strong><span class="classifier">int, default=1</span></dt><dd><p>The maximum number of conformers to produce</p>
</dd>
<dt><strong>rms_cutoff</strong><span class="classifier">openff.unit.Quantity-wrapped float, in units of distance, optional, default=None</span></dt><dd><p>The minimum RMS value at which two conformers are considered redundant and one is deleted. Precise
implementation of this cutoff may be toolkit-dependent. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the cutoff is set to be the
default value for each <code class="docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> (generally 1 Angstrom).</p>
</dd>
<dt><strong>clear_existing</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to overwrite existing conformers for the molecule</p>
</dd>
<dt><strong>make_carboxylic_acids_cis: bool, default=True</strong></dt><dd><p>Guarantee all conformers have exclusively cis carboxylic acid groups (COOH)
by rotating the proton in any trans carboxylic acids 180 degrees around the
C-O bond. Works around a bug in conformer generation by the OpenEye toolkit
where trans COOH is much more common than it should be.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'CCCCCC'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">generate_conformers</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.generate_unique_atom_names">
<span class="sig-name descname"><span class="pre">generate_unique_atom_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.generate_unique_atom_names" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Generate unique atom names from the element symbol and count.</p>
<p>Names are generated from the elemental symbol and the number of times
that element is found in the molecule. The character ‘x’ is appended to
these generated names to reduce the odds that they clash with an atom
name or type imported from another source. For example, generated atom
names might begin ‘C1x’, ‘H1x’, ‘O1x’, ‘C2x’, etc.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.get_bond_between">
<span class="sig-name descname"><span class="pre">get_bond_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Atom</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Atom</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Bond</span></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.get_bond_between" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Returns the bond between two atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>i, j</strong><span class="classifier">int or Atom</span></dt><dd><p>Atoms or atom indices to check</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>bond</strong><span class="classifier">Bond</span></dt><dd><p>The bond between i and j.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.has_unique_atom_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_unique_atom_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.has_unique_atom_names" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the molecule has unique atom names, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.hierarchy_schemes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hierarchy_schemes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.HierarchyScheme</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.hierarchy_schemes" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>The hierarchy schemes available on the molecule.</p>
<p>Hierarchy schemes allow iteration over groups of atoms according to
their metadata. For more information, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchyScheme</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>A dict of the form {str: HierarchyScheme}</dt><dd><p>The HierarchySchemes associated with the molecule.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_hierarchy_scheme" title="openff.toolkit.topology.Molecule.add_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.add_hierarchy_scheme</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.delete_hierarchy_scheme" title="openff.toolkit.topology.Molecule.delete_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.delete_hierarchy_scheme</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="openff.toolkit.topology.Molecule.update_hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.update_hierarchy_schemes</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Topology.hierarchy_iterator</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">HierarchyScheme</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.hill_formula">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hill_formula</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.hill_formula" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Get the Hill formula of the molecule</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.impropers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">impropers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.impropers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Iterate over all improper torsions in the molecule.</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we need to return a <code class="docutils literal notranslate"><span class="pre">Torsion</span></code> object that collects information about fractional bond orders?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>impropers</strong><span class="classifier">set of tuple</span></dt><dd><p>An iterator of tuples, each containing the atoms making
up a possible improper torsion.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="openff.toolkit.topology.Molecule.smirnoff_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smirnoff_impropers</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.amber_impropers" title="openff.toolkit.topology.Molecule.amber_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.is_isomorphic_with">
<span class="sig-name descname"><span class="pre">is_isomorphic_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">FrozenMolecule</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Graph</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.is_isomorphic_with" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Check if the molecule is isomorphic with the other molecule which can be an openff.toolkit.topology.Molecule
or nx.Graph(). Full matching is done using the options described bellow.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>other: openff.toolkit.topology.Molecule or nx.Graph()</strong></dt><dd></dd>
<dt><strong>aromatic_matching: bool, default=True, optional</strong></dt><dd></dd>
<dt><strong>compare the aromatic attributes of bonds and atoms.</strong></dt><dd></dd>
<dt><strong>formal_charge_matching: bool, default=True, optional</strong></dt><dd></dd>
<dt><strong>compare the formal charges attributes of the atoms.</strong></dt><dd></dd>
<dt><strong>bond_order_matching: bool, deafult=True, optional</strong></dt><dd></dd>
<dt><strong>compare the bond order on attributes of the bonds.</strong></dt><dd></dd>
<dt><strong>atom_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, atoms’ stereochemistry is ignored for the
purpose of determining equality.</p>
</dd>
<dt><strong>bond_stereochemistry_matching</strong><span class="classifier">bool, default=True, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, bonds’ stereochemistry is ignored for the
purpose of determining equality.</p>
</dd>
<dt><strong>strip_pyrimidal_n_atom_stereo: bool, default=True, optional</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, any stereochemistry defined around pyrimidal
nitrogen stereocenters will be disregarded in the isomorphism
check.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for
removing stereochemistry from pyrimidal nitrogens.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>isomorphic</strong><span class="classifier">bool</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_angles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Number of angles in the molecule.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_atoms" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>The number of Atom objects.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_bonds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_bonds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_bonds" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>The number of Bond objects in the molecule.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_conformers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_conformers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_conformers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>The number of conformers for this molecule.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_impropers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_impropers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_impropers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Number of possible improper torsions in the molecule.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_particles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_particles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_particles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0: </span>This property has been deprecated and will soon be removed. Use
<a class="reference internal" href="#openff.toolkit.topology.Molecule.n_atoms" title="openff.toolkit.topology.Molecule.n_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.n_atoms()</span></code></a> instead.</p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.n_propers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_propers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.n_propers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Number of proper torsions in the molecule.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.name" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>The name (or title) of the molecule</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.nth_degree_neighbors">
<span class="sig-name descname"><span class="pre">nth_degree_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_degrees</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.nth_degree_neighbors" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return canonicalized pairs of atoms whose shortest separation is <cite>exactly</cite> n bonds.
Only pairs with increasing atom indices are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n: int</strong></dt><dd><p>The number of bonds separating atoms in each pair</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>neighbors: iterator of tuple of Atom</dt><dd><p>Tuples (len 2) of atom that are separated by <code class="docutils literal notranslate"><span class="pre">n</span></code> bonds.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The criteria used here relies on minimum distances; when there are multiple valid
paths between atoms, such as atoms in rings, the shortest path is considered.
For example, two atoms in “meta” positions with respect to each other in a benzene
are separated by two paths, one length 2 bonds and the other length 4 bonds. This
function would consider them to be 2 apart and would not include them if <code class="docutils literal notranslate"><span class="pre">n=4</span></code> was
passed.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.ordered_connection_table_hash">
<span class="sig-name descname"><span class="pre">ordered_connection_table_hash</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.ordered_connection_table_hash" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Compute an ordered hash of the atoms and bonds in the molecule</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.partial_charges">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">partial_charges</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.partial_charges" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Returns the partial charges (if present) on the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>partial_charges</strong><span class="classifier">a openff.unit.Quantity - wrapped numpy array [1 x n_atoms] or None</span></dt><dd><p>The partial charges on the molecule’s atoms. Returns None if no charges have been specified.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.particle">
<span class="sig-name descname"><span class="pre">particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Atom</span></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.particle" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0: </span>This method has been deprecated and will soon be removed. Use
<a class="reference internal" href="#openff.toolkit.topology.Molecule.atom" title="openff.toolkit.topology.Molecule.atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.atom()</span></code></a> instead.</p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.particle_index">
<span class="sig-name descname"><span class="pre">particle_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atom</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.particle_index" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0: </span>This method has been deprecated and will soon be removed. Use
<a class="reference internal" href="#openff.toolkit.topology.Molecule.atom_index" title="openff.toolkit.topology.Molecule.atom_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.atom_index()</span></code></a> instead.</p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.particles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">particles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.particles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11.0: </span>This property has been deprecated and will soon be removed. Use
<a class="reference internal" href="#openff.toolkit.topology.Molecule.atoms" title="openff.toolkit.topology.Molecule.atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.atoms()</span></code></a> instead.</p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.propers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">propers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.propers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Iterate over all proper torsions in the molecule</p>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we need to return a <code class="docutils literal notranslate"><span class="pre">Torsion</span></code> object that collects information about fractional bond orders?</p></li>
</ul>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.properties">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">properties</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.properties" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>The properties dictionary of the molecule</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.remap">
<span class="sig-name descname"><span class="pre">remap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_to_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.remap" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Reorder the atoms in the molecule according to the given mapping dict.</p>
<p>The mapping dict must be a dictionary mapping atom indices to atom
indices. Each atom index must be an integer in the half-open interval
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">n_atoms)</span></code>; ie, it must be a valid index into the <code class="docutils literal notranslate"><span class="pre">self.atoms</span></code>
list. All atom indices in the molecule must be mapped from and to
exactly once unless <code class="docutils literal notranslate"><span class="pre">partial=True</span></code> is given, in which case they must
be mapped no more than once. Missing (unless <code class="docutils literal notranslate"><span class="pre">partial=True</span></code>),
out-of-range (including non-integer), or duplicate indices are not
allowed in the <code class="docutils literal notranslate"><span class="pre">mapping_dict</span></code> and will lead to an exception.</p>
<p>By default, the mapping dict’s keys are the source indices and its
values are destination indices, but this can be changed with the
<code class="docutils literal notranslate"><span class="pre">current_to_new</span></code> argument.</p>
<p>The keys of the <code class="docutils literal notranslate"><span class="pre">self.properties["atom_map"]</span></code> property are updated for
the new ordering. Other values of the properties dictionary are
transferred unchanged.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mapping_dict</strong></dt><dd><p>A dictionary of the mapping between indices. The mapping should be
indexed starting from 0 for both the source and destination; note
that SMILES atom mapping is typically 1-based.</p>
</dd>
<dt><strong>current_to_new</strong></dt><dd><p>If this is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">mapping_dict</span></code> is of the form
<code class="docutils literal notranslate"><span class="pre">{current_index:</span> <span class="pre">new_index}</span></code>; otherwise, it is of the form
<code class="docutils literal notranslate"><span class="pre">{new_index:</span> <span class="pre">current_index}</span></code>.</p>
</dd>
<dt><strong>partial</strong></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default), an exception will be raised if any atom
is lacking a destination in the atom map. Note that if this is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, atoms without entries in the mapping dict may be moved in
addition to those in the dictionary. Note that partial maps must
still be in-range and not include duplicates.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>new_molecule</strong><span class="classifier">openff.toolkit.topology.molecule.Molecule</span></dt><dd><p>A copy of the molecule in the new order.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>RemapIndexError</dt><dd><p>When an out-of-range, duplicate, or missing index is found in the
<code class="docutils literal notranslate"><span class="pre">mapping_dict</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.from_mapped_smiles" title="openff.toolkit.topology.Molecule.from_mapped_smiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_mapped_smiles</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.smirnoff_impropers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">smirnoff_impropers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.smirnoff_impropers" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Iterate over all impropers with trivalent centers, reporting the central atom second.</p>
<p>The central atom is reported second in each torsion. This method reports
an improper for each trivalent atom in the molecule, whether or not any
given force field would assign it improper torsion parameters.</p>
<p>Also note that this will return 6 possible atom orderings around each improper
center. In current SMIRNOFF parameterization, three of these six
orderings will be used for the actual assignment of the improper term
and measurement of the angles. These three orderings capture the three unique
angles that could be calculated around the improper center, therefore the sum
of these three terms will always return a consistent energy.</p>
<p>The exact three orderings that will be applied during parameterization can not be
determined in this method, since it requires sorting the atom indices, and
those indices may change when this molecule is added to a Topology.</p>
<p>For more details on the use of three-fold (‘trefoil’) impropers, see
<a class="reference external" href="https://openforcefield.github.io/standards/standards/smirnoff/#impropertorsions">https://openforcefield.github.io/standards/standards/smirnoff/#impropertorsions</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>impropers</strong><span class="classifier">set of tuple</span></dt><dd><p>An iterator of tuples, each containing the indices of atoms making
up a possible improper torsion. The central atom is listed second
in each tuple.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.impropers" title="openff.toolkit.topology.Molecule.impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impropers</span></code></a>, <a class="reference internal" href="#openff.toolkit.topology.Molecule.amber_impropers" title="openff.toolkit.topology.Molecule.amber_impropers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_impropers</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.strip_atom_stereochemistry">
<span class="sig-name descname"><span class="pre">strip_atom_stereochemistry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smarts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.strip_atom_stereochemistry" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Delete stereochemistry information for certain atoms, if it is present.
This method can be used to “normalize” molecules imported from different cheminformatics
toolkits, which differ in which atom centers are considered stereogenic.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>smarts: str</strong></dt><dd><p>Tagged SMARTS with a single atom with index 1. Any matches for this atom will have any assigned
stereocheistry information removed.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">a <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> object, optional,</span></dt><dd><p>default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for I/O operations</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_bson">
<span class="sig-name descname"><span class="pre">to_bson</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_bson" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a BSON serialized representation.</p>
<p>Specification: <a class="reference external" href="http://bsonspec.org/">http://bsonspec.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A BSON serialized representation of the objecft</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_dict" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a dictionary representation of the molecule.</p>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Document the representation standard.</p></li>
<li><p>How do we do version control with this standard?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecule_dict</strong><span class="classifier">dict</span></dt><dd><p>A dictionary representation of the molecule.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_file" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Write the current molecule to a file or file-like object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_path</strong><span class="classifier">str or file-like object</span></dt><dd><p>A file-like object or the path to the file to be written.</p>
</dd>
<dt><strong>file_format</strong><span class="classifier">str</span></dt><dd><p>Format specifier, one of [‘MOL2’, ‘MOL2H’, ‘SDF’, ‘PDB’, ‘SMI’, ‘CAN’, ‘TDT’]
Note that not all toolkits support all formats</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=GLOBAL_TOOLKIT_REGISTRY
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for file writing. If a Toolkit is passed,
only the highest-precedence toolkit is used</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>If the requested file_format is not supported by one of the installed cheminformatics toolkits</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'imatinib'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">'imatinib.mol2'</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">'mol2'</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">'imatinib.sdf'</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">'sdf'</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">'imatinib.pdb'</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">'pdb'</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_hill_formula">
<span class="sig-name descname"><span class="pre">to_hill_formula</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_hill_formula" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Generate the Hill formula of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>formula</strong><span class="classifier">the Hill formula of the molecule</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>NotImplementedError</strong><span class="classifier">if the molecule is not of one of the specified types.</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_inchi">
<span class="sig-name descname"><span class="pre">to_inchi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fixed_hydrogens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_inchi" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create an InChI string for the molecule using the requested toolkit backend.
InChI is a standardised representation that does not capture tautomers unless specified using the fixed
hydrogen layer.</p>
<p>For information on InChi see here <a class="reference external" href="https://iupac.org/who-we-are/divisions/division-details/inchi/">https://iupac.org/who-we-are/divisions/division-details/inchi/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fixed_hydrogens: bool, default=False</strong></dt><dd><p>If a fixed hydrogen layer should be added to the InChI, if <cite>True</cite> this will produce a non standard
specific InChI string of the molecule.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for molecule-to-InChI conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>inchi: str</dt><dd><p>The InChI string of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_inchikey">
<span class="sig-name descname"><span class="pre">to_inchikey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fixed_hydrogens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_inchikey" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create an InChIKey for the molecule using the requested toolkit backend.
InChIKey is a standardised representation that does not capture tautomers unless specified
using the fixed hydrogen layer.</p>
<p>For information on InChi see here <a class="reference external" href="https://iupac.org/who-we-are/divisions/division-details/inchi/">https://iupac.org/who-we-are/divisions/division-details/inchi/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fixed_hydrogens: bool, default=False</strong></dt><dd><p>If a fixed hydrogen layer should be added to the InChI, if <cite>True</cite> this will produce a non standard specific
InChI string of the molecule.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolRegistry</span></dt><dd><p>or openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for molecule-to-InChIKey conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>inchi_key: str</dt><dd><p>The InChIKey representation of the molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>InvalidToolkitRegistryError</dt><dd><p>If an invalid object is passed as the toolkit_registry parameter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_iupac">
<span class="sig-name descname"><span class="pre">to_iupac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_iupac" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Generate IUPAC name from Molecule</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iupac_name</strong><span class="classifier">str</span></dt><dd><p>IUPAC name of the molecule</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method requires the OpenEye toolkit to be installed.
..</p>
</div>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">'molecules/ethanol.sdf'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iupac_name</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_iupac</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_json" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a JSON serialized representation.</p>
<p>Specification: <a class="reference external" href="https://www.json.org/">https://www.json.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indent</strong><span class="classifier">int, optional, default=None</span></dt><dd><p>If not None, will pretty-print with specified number of spaces for indentation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A JSON serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_messagepack">
<span class="sig-name descname"><span class="pre">to_messagepack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_messagepack" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a MessagePack representation.</p>
<p>Specification: <a class="reference external" href="https://msgpack.org/index.html">https://msgpack.org/index.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A MessagePack-encoded bytes serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_networkx">
<span class="sig-name descname"><span class="pre">to_networkx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_networkx" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Generate a NetworkX undirected graph from the molecule.</p>
<p>Nodes are Atoms labeled with atom indices and atomic elements (via the <code class="docutils literal notranslate"><span class="pre">element</span></code> node atrribute).
Edges denote chemical bonds between Atoms.</p>
<div class="admonition-todo admonition" id="id8">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Do we need a <code class="docutils literal notranslate"><span class="pre">from_networkx()</span></code> method? If so, what would the Graph be required to provide?</p></li>
<li><p>Should edges be labeled with discrete bond types in some aromaticity model?</p></li>
<li><p>Should edges be labeled with fractional bond order if a method is specified?</p></li>
<li><p>Should we add other per-atom and per-bond properties (e.g. partial charges) if present?</p></li>
<li><p>Can this encode bond/atom chirality?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>graph</strong><span class="classifier">networkx.Graph</span></dt><dd><p>The resulting graph, with nodes (atoms) labeled with atom indices, elements, stereochemistry and
aromaticity flags and bonds with two atom indices, bond order, stereochemistry, and aromaticity flags</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Retrieve the bond graph for imatinib (OpenEye toolkit required)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'imatinib'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nxgraph</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_openeye">
<span class="sig-name descname"><span class="pre">to_openeye</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aromaticity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DEFAULT_AROMATICITY_MODEL</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_openeye" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create an OpenEye molecule</p>
<p>Requires the OpenEye toolkit to be installed.</p>
<div class="admonition-todo admonition" id="id9">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Use stored conformer positions instead of an argument.</p></li>
<li><p>Should the aromaticity model be specified in some other way?</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>aromaticity_model</strong><span class="classifier">str, optional, default=”OEAroModel_MDL”</span></dt><dd><p>The aromaticity model to use. Only OEAroModel_MDL is supported.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>oemol</strong><span class="classifier">openeye.oechem.OEMol</span></dt><dd><p>An OpenEye molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create an OpenEye molecule from a Molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'CC'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oemol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_openeye</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_pickle">
<span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_pickle" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a pickle serialized representation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not recommended for safe, stable storage since the pickle specification
may change between Python versions.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A pickled representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_qcschema">
<span class="sig-name descname"><span class="pre">to_qcschema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiplicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_qcschema" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create a QCElemental Molecule.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>multiplicity</strong><span class="classifier">int, default=1,</span></dt><dd><p>The multiplicity of the molecule;
sets <code class="docutils literal notranslate"><span class="pre">molecular_multiplicity</span></code> field for QCElemental Molecule.</p>
</dd>
<dt><strong>conformer</strong><span class="classifier">int, default=0,</span></dt><dd><p>The index of the conformer to use for the QCElemental Molecule geometry.</p>
</dd>
<dt><strong>extras</strong><span class="classifier">dict, default=None</span></dt><dd><p>A dictionary that should be included in the <code class="docutils literal notranslate"><span class="pre">extras</span></code> field on the QCElemental Molecule.
This can be used to include extra information, such as a smiles representation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>qcelemental.models.Molecule</dt><dd><p>A validated QCElemental Molecule.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>MissingOptionalDependencyError</dt><dd><p>If qcelemental is not installed, the qcschema can not be validated.</p>
</dd>
<dt>InvalidConformerError</dt><dd><p>No conformer found at the given index.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a QCElemental Molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">qcelemental</span> <span class="k">as</span> <span class="nn">qcel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="s1">'CC'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">generate_conformers</span><span class="p">(</span><span class="n">n_conformers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qcemol</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">to_qcschema</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_rdkit">
<span class="sig-name descname"><span class="pre">to_rdkit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aromaticity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DEFAULT_AROMATICITY_MODEL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_rdkit" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Create an RDKit molecule</p>
<p>Requires the RDKit to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>aromaticity_model</strong><span class="classifier">str, optional, default=”OEAroModel_MDL”</span></dt><dd><p>The aromaticity model to use. Only OEAroModel_MDL is supported.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rdmol</strong><span class="classifier">rdkit.RDMol</span></dt><dd><p>An RDKit molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Convert a molecule to RDKit</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">'molecules/ethanol.sdf'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdmol</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_smiles">
<span class="sig-name descname"><span class="pre">to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isomeric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit_hydrogens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ToolkitRegistry</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ToolkitWrapper</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GLOBAL_TOOLKIT_REGISTRY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_smiles" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a canonical isomeric SMILES representation of the current molecule.
A partially mapped smiles can also be generated for atoms of interest by supplying an <cite>atom_map</cite> to the
properties dictionary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RDKit and OpenEye versions will not necessarily return the same representation.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>isomeric: bool optional, default= True</strong></dt><dd><p>return an isomeric smiles</p>
</dd>
<dt><strong>explicit_hydrogens: bool optional, default=True</strong></dt><dd><p>return a smiles string containing all hydrogens explicitly</p>
</dd>
<dt><strong>mapped: bool optional, default=False</strong></dt><dd><p>return a explicit hydrogen mapped smiles, the atoms to be mapped can be controlled by supplying an
atom map into the properties dictionary. If no mapping is passed all atoms will be mapped in order, else
an atom map dictionary from the current atom index to the map id should be supplied with no duplicates.
The map ids (values) should start from 0 or 1.</p>
</dd>
<dt><strong>toolkit_registry</strong><span class="classifier">openff.toolkit.utils.toolkits.ToolkitRegistry or</span></dt><dd><p>openff.toolkit.utils.toolkits.ToolkitWrapper, optional, default=None
<code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitRegistry</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">ToolkitWrapper</span></code> to use for SMILES conversion</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>smiles</strong><span class="classifier">str</span></dt><dd><p>Canonical isomeric explicit-hydrogen SMILES</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.utils</span> <span class="kn">import</span> <span class="n">get_data_file_path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sdf_filepath</span> <span class="o">=</span> <span class="n">get_data_file_path</span><span class="p">(</span><span class="s1">'molecules/ethanol.sdf'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">sdf_filepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smiles</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_toml">
<span class="sig-name descname"><span class="pre">to_toml</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_toml" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a TOML serialized representation.</p>
<p>Specification: <a class="reference external" href="https://github.com/toml-lang/toml">https://github.com/toml-lang/toml</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A TOML serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_topology">
<span class="sig-name descname"><span class="pre">to_topology</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_topology" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return an OpenFF Topology representation containing one copy of this molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>topology</strong><span class="classifier">openff.toolkit.topology.Topology</span></dt><dd><p>A Topology representation of this molecule</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_iupac</span><span class="p">(</span><span class="s1">'imatinib'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topology</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">to_topology</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_xml">
<span class="sig-name descname"><span class="pre">to_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_xml" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return an XML representation.</p>
<p>Specification: <a class="reference external" href="https://www.w3.org/XML/">https://www.w3.org/XML/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indent</strong><span class="classifier">int, optional, default=2</span></dt><dd><p>If not None, will pretty-print with specified number of spaces for indentation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">bytes</span></dt><dd><p>A MessagePack-encoded bytes serialized representation.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.to_yaml">
<span class="sig-name descname"><span class="pre">to_yaml</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.to_yaml" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return a YAML serialized representation.</p>
<p>Specification: <a class="reference external" href="http://yaml.org/">http://yaml.org/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serialized</strong><span class="classifier">str</span></dt><dd><p>A YAML serialized representation of the object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.torsions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">torsions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">openff.toolkit.topology.molecule.Atom</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#openff.toolkit.topology.Molecule.torsions" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Get an iterator over all i-j-k-l torsions.
Note that i-j-k-i torsions (cycles) are excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>torsions</strong><span class="classifier">iterable of 4-Atom tuples</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.total_charge">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_charge</span></span><a class="headerlink" href="#openff.toolkit.topology.Molecule.total_charge" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Return the total charge on the molecule</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openff.toolkit.topology.Molecule.update_hierarchy_schemes">
<span class="sig-name descname"><span class="pre">update_hierarchy_schemes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openff.toolkit.topology.Molecule.update_hierarchy_schemes" title="Permalink to this definition"><i class="fas fa-link"></i></a></dt>
<dd><p>Infer a hierarchy from atom metadata according to the existing hierarchy
schemes.</p>
<p>Hierarchy schemes allow iteration over groups of atoms according to
their metadata. For more information, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">HierarchyScheme</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>iter_names</strong><span class="classifier">Iterable of str, Optional</span></dt><dd><p>Only perceive hierarchy for HierarchySchemes that expose these
iterator names. If not provided, all known hierarchies will be
perceived, overwriting previous results if applicable.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.add_hierarchy_scheme" title="openff.toolkit.topology.Molecule.add_hierarchy_scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.add_hierarchy_scheme</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.delete_hierarchy_schemes</span></code></dt><dd></dd>
<dt><a class="reference internal" href="#openff.toolkit.topology.Molecule.hierarchy_schemes" title="openff.toolkit.topology.Molecule.hierarchy_schemes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Molecule.hierarchy_schemes</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">HierarchyScheme</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>
</dd></dl>
</section>
</article>
</div>
<aside class="column is-hidden-touch is-2">
</aside>
</div>
</main>
<footer class="footer">
<div class="footer-content">
<nav class="level">
<div class="level-left">
<div class="level-item">
<a class="icon-text" href="../numpydoc.html" rel="prev" title="Openff-toolkit example">
<span class="icon">
<i class="fas fa-arrow-left"></i>
</span>
<span class="is-size-5">Openff-toolkit example</span>
</a>
</div>
</div>
<div class="level-right">
<div class="level-item">
<a class="icon-text" href="../pydantic.html" rel="next" title="Pydantic API docs">
<span class="is-size-5">Pydantic API docs</span>
<span class="icon">
<i class="fas fa-arrow-right"></i>
</span>
</a>
</div>
</div>
</nav>
<div class="columns">
<div class="fineprint column">
<div class="copyright">
              © Copyright 2021, Open Force Field Initiative.
              
          </div>
          Last updated on
            Mar 23, 2023.
          <br/>
          Created using
          <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
           and
          <a href="https://github.com/openforcefield/openff-sphinx-theme/">the Open Force Field Sphinx theme</a>
</div>
<div class="socials column">
<p class="pb-3">An <a class="has-text-white" href="https://openforcefield.org/">Open Force Field Initiative</a> project.</p>
<div>
<a class="icon has-text-light is-medium" href="https://zenodo.org/communities/openforcefield/" title="OpenFF on Zenodo">
<i class="fa-lg ai-lg ai ai-zenodo"></i>
</a>
<a class="icon has-text-light is-medium" href="https://www.youtube.com/channel/UCh0aJSUm_sYr7nuTzhW806g" title="OpenFF on YouTube">
<i class="fa-lg ai-lg fab fa-youtube"></i>
</a>
<a class="icon has-text-light is-medium" href="https://github.com/openforcefield" title="OpenFF on GitHub">
<i class="fa-lg ai-lg fab fa-github"></i>
</a>
<a class="icon has-text-light is-medium" href="https://twitter.com/openforcefield" title="OpenFF on Twitter">
<i class="fa-lg ai-lg fab fa-twitter"></i>
</a>
<a class="icon has-text-light is-medium" href="https://www.linkedin.com/company/openforcefield/" title="OpenFF on LinkedIn">
<i class="fa-lg ai-lg fab fa-linkedin"></i>
</a>
</div>
</div>
</div>
</div>
</footer>
</body>
</html>